<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Part19 ggplot2 package | Introduction to R</title>
  <meta name="description" content="Part19 ggplot2 package | Introduction to R" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Part19 ggplot2 package | Introduction to R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Part19 ggplot2 package | Introduction to R" />
  
  
  

<meta name="author" content="Sarah Bonnin" />


<meta name="date" content="2019-08-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="plots-from-other-packages.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a></li>
<li class="chapter" data-level="2" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i><b>2</b> What is R ?</a></li>
<li class="chapter" data-level="3" data-path="what-is-rstudio.html"><a href="what-is-rstudio.html"><i class="fa fa-check"></i><b>3</b> What is RStudio ?</a><ul>
<li class="chapter" data-level="3.1" data-path="what-is-rstudio.html"><a href="what-is-rstudio.html#rstudio-access"><i class="fa fa-check"></i><b>3.1</b> RStudio access</a></li>
<li class="chapter" data-level="3.2" data-path="what-is-rstudio.html"><a href="what-is-rstudio.html#rstudio-interface"><i class="fa fa-check"></i><b>3.2</b> RStudio interface</a></li>
<li class="chapter" data-level="3.3" data-path="what-is-rstudio.html"><a href="what-is-rstudio.html#setting-up-the-folder-structure-for-the-course"><i class="fa fa-check"></i><b>3.3</b> Setting up the folder structure for the course</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="paths-and-directories.html"><a href="paths-and-directories.html"><i class="fa fa-check"></i><b>4</b> Paths and directories</a><ul>
<li class="chapter" data-level="4.1" data-path="paths-and-directories.html"><a href="paths-and-directories.html#tree-of-directories"><i class="fa fa-check"></i><b>4.1</b> Tree of directories</a></li>
<li class="chapter" data-level="4.2" data-path="paths-and-directories.html"><a href="paths-and-directories.html#navigate-the-tree-of-directory-with-the-r-terminal"><i class="fa fa-check"></i><b>4.2</b> Navigate the tree of directory with the R terminal</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>5</b> R basics</a><ul>
<li class="chapter" data-level="5.1" data-path="r-basics.html"><a href="r-basics.html#arithmetic-operators"><i class="fa fa-check"></i><b>5.1</b> Arithmetic operators</a></li>
<li class="chapter" data-level="5.2" data-path="r-basics.html"><a href="r-basics.html#simple-calculations"><i class="fa fa-check"></i><b>5.2</b> Simple calculations</a></li>
<li class="chapter" data-level="5.3" data-path="r-basics.html"><a href="r-basics.html#objects-in-r"><i class="fa fa-check"></i><b>5.3</b> Objects in R</a></li>
<li class="chapter" data-level="5.4" data-path="r-basics.html"><a href="r-basics.html#assignment-operators"><i class="fa fa-check"></i><b>5.4</b> Assignment operators</a></li>
<li class="chapter" data-level="5.5" data-path="r-basics.html"><a href="r-basics.html#assigning-data-to-an-object"><i class="fa fa-check"></i><b>5.5</b> Assigning data to an object</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>6</b> Functions</a></li>
<li class="chapter" data-level="7" data-path="r-scripts.html"><a href="r-scripts.html"><i class="fa fa-check"></i><b>7</b> R scripts</a><ul>
<li class="chapter" data-level="7.1" data-path="r-scripts.html"><a href="r-scripts.html#create-and-save-a-script"><i class="fa fa-check"></i><b>7.1</b> Create and save a script</a></li>
<li class="chapter" data-level="7.2" data-path="r-scripts.html"><a href="r-scripts.html#r-syntax"><i class="fa fa-check"></i><b>7.2</b> R syntax</a></li>
<li class="chapter" data-level="7.3" data-path="r-scripts.html"><a href="r-scripts.html#rstudio-tips-in-the-console"><i class="fa fa-check"></i><b>7.3</b> RStudio tips in the console</a></li>
<li class="chapter" data-level="7.4" data-path="r-scripts.html"><a href="r-scripts.html#exercice-1.-getting-started."><i class="fa fa-check"></i><b>7.4</b> Exercice 1. Getting started.</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>8</b> Data types</a></li>
<li class="chapter" data-level="9" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>9</b> Data structures</a><ul>
<li class="chapter" data-level="9.1" data-path="data-structures.html"><a href="data-structures.html#vectors"><i class="fa fa-check"></i><b>9.1</b> Vectors</a><ul>
<li class="chapter" data-level="9.1.1" data-path="data-structures.html"><a href="data-structures.html#creating-a-vector"><i class="fa fa-check"></i><b>9.1.1</b> Creating a vector</a></li>
<li class="chapter" data-level="9.1.2" data-path="data-structures.html"><a href="data-structures.html#vector-manipulation"><i class="fa fa-check"></i><b>9.1.2</b> Vector manipulation</a></li>
<li class="chapter" data-level="9.1.3" data-path="data-structures.html"><a href="data-structures.html#combining-vectors"><i class="fa fa-check"></i><b>9.1.3</b> Combining vectors</a></li>
<li class="chapter" data-level="9.1.4" data-path="data-structures.html"><a href="data-structures.html#numeric-vector-manipulation"><i class="fa fa-check"></i><b>9.1.4</b> Numeric vector manipulation</a></li>
<li class="chapter" data-level="9.1.5" data-path="data-structures.html"><a href="data-structures.html#character-vector-manipulation"><i class="fa fa-check"></i><b>9.1.5</b> Character vector manipulation</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="data-structures.html"><a href="data-structures.html#exercise-2.-numeric-vector-manipulation"><i class="fa fa-check"></i><b>9.2</b> Exercise 2. Numeric vector manipulation</a><ul>
<li class="chapter" data-level="9.2.1" data-path="data-structures.html"><a href="data-structures.html#exercise-2a."><i class="fa fa-check"></i><b>9.2.1</b> Exercise 2a.</a></li>
<li class="chapter" data-level="9.2.2" data-path="data-structures.html"><a href="data-structures.html#exercise-2b."><i class="fa fa-check"></i><b>9.2.2</b> Exercise 2b.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="data-structures.html"><a href="data-structures.html#exercise-3.-character-vector-manipulation"><i class="fa fa-check"></i><b>9.3</b> Exercise 3. Character vector manipulation</a><ul>
<li class="chapter" data-level="9.3.1" data-path="data-structures.html"><a href="data-structures.html#exercise-3a."><i class="fa fa-check"></i><b>9.3.1</b> Exercise 3a.</a></li>
<li class="chapter" data-level="9.3.2" data-path="data-structures.html"><a href="data-structures.html#exercise-3b."><i class="fa fa-check"></i><b>9.3.2</b> Exercise 3b.</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="data-structures.html"><a href="data-structures.html#factors"><i class="fa fa-check"></i><b>9.4</b> Factors</a></li>
<li class="chapter" data-level="9.5" data-path="data-structures.html"><a href="data-structures.html#matrices"><i class="fa fa-check"></i><b>9.5</b> Matrices</a><ul>
<li class="chapter" data-level="9.5.1" data-path="data-structures.html"><a href="data-structures.html#creating-a-matrix"><i class="fa fa-check"></i><b>9.5.1</b> Creating a matrix</a></li>
<li class="chapter" data-level="9.5.2" data-path="data-structures.html"><a href="data-structures.html#two-dimensional-object"><i class="fa fa-check"></i><b>9.5.2</b> Two-dimensional object</a></li>
<li class="chapter" data-level="9.5.3" data-path="data-structures.html"><a href="data-structures.html#matrix-manipulation"><i class="fa fa-check"></i><b>9.5.3</b> Matrix manipulation</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="data-structures.html"><a href="data-structures.html#data-frames"><i class="fa fa-check"></i><b>9.6</b> Data frames</a><ul>
<li class="chapter" data-level="9.6.1" data-path="data-structures.html"><a href="data-structures.html#create-a-data-frame"><i class="fa fa-check"></i><b>9.6.1</b> Create a data frame</a></li>
<li class="chapter" data-level="9.6.2" data-path="data-structures.html"><a href="data-structures.html#data-frame-manipulation"><i class="fa fa-check"></i><b>9.6.2</b> Data frame manipulation:</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="data-structures.html"><a href="data-structures.html#two-dimensional-structures-manipulation"><i class="fa fa-check"></i><b>9.7</b> Two-dimensional structures manipulation</a><ul>
<li class="chapter" data-level="9.7.1" data-path="data-structures.html"><a href="data-structures.html#dimensions"><i class="fa fa-check"></i><b>9.7.1</b> Dimensions</a></li>
<li class="chapter" data-level="9.7.2" data-path="data-structures.html"><a href="data-structures.html#manipulation"><i class="fa fa-check"></i><b>9.7.2</b> Manipulation</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="data-structures.html"><a href="data-structures.html#exercise-4.-matrix-manipulation"><i class="fa fa-check"></i><b>9.8</b> Exercise 4. Matrix manipulation</a></li>
<li class="chapter" data-level="9.9" data-path="data-structures.html"><a href="data-structures.html#exercise-5.-data-frame-manipulation"><i class="fa fa-check"></i><b>9.9</b> Exercise 5. Data frame manipulation</a><ul>
<li class="chapter" data-level="9.9.1" data-path="data-structures.html"><a href="data-structures.html#exercise-5a"><i class="fa fa-check"></i><b>9.9.1</b> Exercise 5a</a></li>
<li class="chapter" data-level="9.9.2" data-path="data-structures.html"><a href="data-structures.html#exercise-5b"><i class="fa fa-check"></i><b>9.9.2</b> Exercise 5b</a></li>
<li class="chapter" data-level="9.9.3" data-path="data-structures.html"><a href="data-structures.html#exercise-5c"><i class="fa fa-check"></i><b>9.9.3</b> Exercise 5c</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>10</b> Missing values</a></li>
<li class="chapter" data-level="11" data-path="input-output.html"><a href="input-output.html"><i class="fa fa-check"></i><b>11</b> Input / Output</a><ul>
<li class="chapter" data-level="11.1" data-path="input-output.html"><a href="input-output.html#on-vectors"><i class="fa fa-check"></i><b>11.1</b> On vectors</a></li>
<li class="chapter" data-level="11.2" data-path="input-output.html"><a href="input-output.html#on-data-frames-or-matrices"><i class="fa fa-check"></i><b>11.2</b> On data frames or matrices</a></li>
<li class="chapter" data-level="11.3" data-path="input-output.html"><a href="input-output.html#exercise-6."><i class="fa fa-check"></i><b>11.3</b> Exercise 6.</a><ul>
<li class="chapter" data-level="11.3.1" data-path="input-output.html"><a href="input-output.html#exercise-6a.-input-output"><i class="fa fa-check"></i><b>11.3.1</b> Exercise 6a. Input / output</a></li>
<li class="chapter" data-level="11.3.2" data-path="input-output.html"><a href="input-output.html#exercise-6b---io-on-data-frame-play-with-the-arguments-of-read.table"><i class="fa fa-check"></i><b>11.3.2</b> Exercise 6b - I/O on data frame: play with the arguments of read.table</a></li>
<li class="chapter" data-level="11.3.3" data-path="input-output.html"><a href="input-output.html#exercice-6c---io-on-a-data-frame"><i class="fa fa-check"></i><b>11.3.3</b> Exercice 6c - I/O on a data frame</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="library-and-packages.html"><a href="library-and-packages.html"><i class="fa fa-check"></i><b>12</b> Library and packages</a><ul>
<li class="chapter" data-level="12.1" data-path="library-and-packages.html"><a href="library-and-packages.html#r-base"><i class="fa fa-check"></i><b>12.1</b> R base</a></li>
<li class="chapter" data-level="12.2" data-path="library-and-packages.html"><a href="library-and-packages.html#r-contrib"><i class="fa fa-check"></i><b>12.2</b> R contrib</a></li>
<li class="chapter" data-level="12.3" data-path="library-and-packages.html"><a href="library-and-packages.html#install-a-package"><i class="fa fa-check"></i><b>12.3</b> Install a package</a></li>
<li class="chapter" data-level="12.4" data-path="library-and-packages.html"><a href="library-and-packages.html#load-a-package"><i class="fa fa-check"></i><b>12.4</b> Load a package</a></li>
<li class="chapter" data-level="12.5" data-path="library-and-packages.html"><a href="library-and-packages.html#check-what-packages-are-currently-loaded"><i class="fa fa-check"></i><b>12.5</b> Check what packages are currently loaded</a></li>
<li class="chapter" data-level="12.6" data-path="library-and-packages.html"><a href="library-and-packages.html#list-functions-from-a-package"><i class="fa fa-check"></i><b>12.6</b> List functions from a package</a></li>
<li class="chapter" data-level="12.7" data-path="library-and-packages.html"><a href="library-and-packages.html#rstudio-server-at-crg"><i class="fa fa-check"></i><b>12.7</b> RStudio server at CRG</a></li>
<li class="chapter" data-level="12.8" data-path="library-and-packages.html"><a href="library-and-packages.html#exercise-7-library-and-packages"><i class="fa fa-check"></i><b>12.8</b> Exercise 7: Library and packages</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="regular-expressions.html"><a href="regular-expressions.html"><i class="fa fa-check"></i><b>13</b> Regular expressions</a><ul>
<li class="chapter" data-level="13.1" data-path="regular-expressions.html"><a href="regular-expressions.html#find-simple-matches-with-grep"><i class="fa fa-check"></i><b>13.1</b> Find simple matches with grep</a></li>
<li class="chapter" data-level="13.2" data-path="regular-expressions.html"><a href="regular-expressions.html#regular-expressions-to-find-more-flexible-patterns"><i class="fa fa-check"></i><b>13.2</b> Regular expressions to find more flexible patterns</a></li>
<li class="chapter" data-level="13.3" data-path="regular-expressions.html"><a href="regular-expressions.html#substitute-or-remove-matching-patterns-with-gsub"><i class="fa fa-check"></i><b>13.3</b> Substitute or remove matching patterns with gsub</a></li>
<li class="chapter" data-level="13.4" data-path="regular-expressions.html"><a href="regular-expressions.html#predefined-variables-to-use-in-regular-expressions"><i class="fa fa-check"></i><b>13.4</b> Predefined variables to use in regular expressions:</a></li>
<li class="chapter" data-level="13.5" data-path="regular-expressions.html"><a href="regular-expressions.html#use-grep-and-regular-expressions-to-retrieve-columns-by-their-names"><i class="fa fa-check"></i><b>13.5</b> Use grep and regular expressions to retrieve columns by their names</a></li>
<li class="chapter" data-level="13.6" data-path="regular-expressions.html"><a href="regular-expressions.html#exercise-8-regular-expressions"><i class="fa fa-check"></i><b>13.6</b> Exercise 8: Regular expressions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="repetitive-execution.html"><a href="repetitive-execution.html"><i class="fa fa-check"></i><b>14</b> Repetitive execution</a><ul>
<li class="chapter" data-level="14.1" data-path="repetitive-execution.html"><a href="repetitive-execution.html#exercise-9-for-loop"><i class="fa fa-check"></i><b>14.1</b> Exercise 9: For loop</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="conditional-statement.html"><a href="conditional-statement.html"><i class="fa fa-check"></i><b>15</b> Conditional statement</a><ul>
<li class="chapter" data-level="15.1" data-path="conditional-statement.html"><a href="conditional-statement.html#exercise-10-if-statement"><i class="fa fa-check"></i><b>15.1</b> Exercise 10: If statement</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="basic-plots-in-r.html"><a href="basic-plots-in-r.html"><i class="fa fa-check"></i><b>16</b> Basic plots in R</a><ul>
<li class="chapter" data-level="16.1" data-path="basic-plots-in-r.html"><a href="basic-plots-in-r.html#scatter-plots"><i class="fa fa-check"></i><b>16.1</b> Scatter plots</a></li>
<li class="chapter" data-level="16.2" data-path="basic-plots-in-r.html"><a href="basic-plots-in-r.html#bar-plots"><i class="fa fa-check"></i><b>16.2</b> Bar plots</a></li>
<li class="chapter" data-level="16.3" data-path="basic-plots-in-r.html"><a href="basic-plots-in-r.html#pie-charts"><i class="fa fa-check"></i><b>16.3</b> Pie charts</a></li>
<li class="chapter" data-level="16.4" data-path="basic-plots-in-r.html"><a href="basic-plots-in-r.html#box-plots"><i class="fa fa-check"></i><b>16.4</b> Box plots</a></li>
<li class="chapter" data-level="16.5" data-path="basic-plots-in-r.html"><a href="basic-plots-in-r.html#histograms"><i class="fa fa-check"></i><b>16.5</b> Histograms</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html"><i class="fa fa-check"></i><b>17</b> How to save plots</a><ul>
<li class="chapter" data-level="17.1" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#with-r-studio"><i class="fa fa-check"></i><b>17.1</b> With R Studio</a></li>
<li class="chapter" data-level="17.2" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#with-the-console"><i class="fa fa-check"></i><b>17.2</b> With the console</a></li>
<li class="chapter" data-level="17.3" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#exercise-11-base-plots"><i class="fa fa-check"></i><b>17.3</b> Exercise 11: Base plots</a><ul>
<li class="chapter" data-level="17.3.1" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#exercise-11a--scatter-plot"><i class="fa fa-check"></i><b>17.3.1</b> Exercise 11a- scatter plot</a></li>
<li class="chapter" data-level="17.3.2" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#exercise-11b--bar-plot-pie-chart"><i class="fa fa-check"></i><b>17.3.2</b> Exercise 11b- bar plot + pie chart</a></li>
<li class="chapter" data-level="17.3.3" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#exercise-11c--histogram"><i class="fa fa-check"></i><b>17.3.3</b> Exercise 11c- histogram</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="plots-from-other-packages.html"><a href="plots-from-other-packages.html"><i class="fa fa-check"></i><b>18</b> Plots from other packages</a><ul>
<li class="chapter" data-level="18.1" data-path="plots-from-other-packages.html"><a href="plots-from-other-packages.html#heatmap.2-function-from-gplots-package"><i class="fa fa-check"></i><b>18.1</b> heatmap.2 function from gplots package</a></li>
<li class="chapter" data-level="18.2" data-path="plots-from-other-packages.html"><a href="plots-from-other-packages.html#venn.diagram-function-from-venndiagram-package"><i class="fa fa-check"></i><b>18.2</b> venn.diagram function from VennDiagram package</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="ggplot2-package.html"><a href="ggplot2-package.html"><i class="fa fa-check"></i><b>19</b> ggplot2 package</a><ul>
<li class="chapter" data-level="19.1" data-path="ggplot2-package.html"><a href="ggplot2-package.html#getting-started"><i class="fa fa-check"></i><b>19.1</b> Getting started</a></li>
<li class="chapter" data-level="19.2" data-path="ggplot2-package.html"><a href="ggplot2-package.html#scatter-plot"><i class="fa fa-check"></i><b>19.2</b> Scatter plot</a></li>
<li class="chapter" data-level="19.3" data-path="ggplot2-package.html"><a href="ggplot2-package.html#box-plots-1"><i class="fa fa-check"></i><b>19.3</b> Box plots</a></li>
<li class="chapter" data-level="19.4" data-path="ggplot2-package.html"><a href="ggplot2-package.html#dot-plots"><i class="fa fa-check"></i><b>19.4</b> Dot plots</a></li>
<li class="chapter" data-level="19.5" data-path="ggplot2-package.html"><a href="ggplot2-package.html#bar-plots-1"><i class="fa fa-check"></i><b>19.5</b> Bar plots</a></li>
<li class="chapter" data-level="19.6" data-path="ggplot2-package.html"><a href="ggplot2-package.html#histograms-1"><i class="fa fa-check"></i><b>19.6</b> Histograms</a></li>
<li class="chapter" data-level="19.7" data-path="ggplot2-package.html"><a href="ggplot2-package.html#about-themes"><i class="fa fa-check"></i><b>19.7</b> About themes</a></li>
<li class="chapter" data-level="19.8" data-path="ggplot2-package.html"><a href="ggplot2-package.html#saving-plots-in-files"><i class="fa fa-check"></i><b>19.8</b> Saving plots in files</a></li>
<li class="chapter" data-level="19.9" data-path="ggplot2-package.html"><a href="ggplot2-package.html#exercise-12-ggplot2"><i class="fa fa-check"></i><b>19.9</b> Exercise 12: ggplot2</a><ul>
<li class="chapter" data-level="19.9.1" data-path="ggplot2-package.html"><a href="ggplot2-package.html#exercise-12a--scatter-plot"><i class="fa fa-check"></i><b>19.9.1</b> Exercise 12a- Scatter plot</a></li>
<li class="chapter" data-level="19.9.2" data-path="ggplot2-package.html"><a href="ggplot2-package.html#exercise-12b--box-plot"><i class="fa fa-check"></i><b>19.9.2</b> Exercise 12b- Box plot</a></li>
<li class="chapter" data-level="19.9.3" data-path="ggplot2-package.html"><a href="ggplot2-package.html#exercise-12c--bar-plot"><i class="fa fa-check"></i><b>19.9.3</b> Exercise 12c- Bar plot</a></li>
<li class="chapter" data-level="19.9.4" data-path="ggplot2-package.html"><a href="ggplot2-package.html#exercise-12d--histogram"><i class="fa fa-check"></i><b>19.9.4</b> Exercise 12d- Histogram</a></li>
</ul></li>
<li class="chapter" data-level="19.10" data-path="ggplot2-package.html"><a href="ggplot2-package.html#more-about-the-theme-function"><i class="fa fa-check"></i><b>19.10</b> More about the theme() function</a></li>
<li class="chapter" data-level="19.11" data-path="ggplot2-package.html"><a href="ggplot2-package.html#volcano-plots"><i class="fa fa-check"></i><b>19.11</b> Volcano plots</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ggplot2-package" class="section level1">
<h1><span class="header-section-number">Part19</span> ggplot2 package</h1>
<ul>
<li><p>Graphing package inspired by the <strong>G</strong>rammar of <strong>G</strong>raphics work of Leland Wilkinson.</p></li>
<li><p>A tool that enables to concisely describe the components of a graphic.</p></li>
<li>Why ggplot2 ?
<ul>
<li>Flexible</li>
<li>Customizable</li>
<li>Pretty !</li>
<li>Well documented</li>
</ul></li>
<li>We will see:
<ul>
<li>Scatter plots</li>
<li>Box plots</li>
<li>Dot plots</li>
<li>Bar plots</li>
<li>Histograms</li>
<li>How to save plots</li>
<li>Volcano plots</li>
</ul></li>
</ul>
<div id="getting-started" class="section level2">
<h2><span class="header-section-number">19.1</span> Getting started</h2>
<ul>
<li>All ggplots start with a <strong>base layer</strong> created with the <strong>ggplot()</strong> function:</li>
</ul>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb521-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataframe, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>column1, <span class="dt">y=</span>column2))</a></code></pre></div>
<p><em>The base layer is setting the grounds but NOT plotting anything</em></p>
<ul>
<li>Add a layer (with the <strong>+</strong> sign) that describes what kind of plot you want.</li>
</ul>
</div>
<div id="scatter-plot" class="section level2">
<h2><span class="header-section-number">19.2</span> Scatter plot</h2>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb522-1" data-line-number="1"><span class="co"># Example of a scatter plot: add the geom_point() layer</span></a>
<a class="sourceLine" id="cb522-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataframe, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>column1, <span class="dt">y=</span>column2)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<ul>
<li>Example of a simple scatter plot:</li>
</ul>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb523-1" data-line-number="1"><span class="co"># Create a data frame</span></a>
<a class="sourceLine" id="cb523-2" data-line-number="2">df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sample1=</span><span class="kw">rnorm</span>(<span class="dv">200</span>), <span class="dt">sample2=</span><span class="kw">rnorm</span>(<span class="dv">200</span>))</a>
<a class="sourceLine" id="cb523-3" data-line-number="3"></a>
<a class="sourceLine" id="cb523-4" data-line-number="4"><span class="co"># Plot !</span></a>
<a class="sourceLine" id="cb523-5" data-line-number="5"><span class="kw">ggplot</span>(<span class="dt">data=</span> df1 , <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>sample1, <span class="dt">y=</span>sample2)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb523-6" data-line-number="6"><span class="st">    </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-302-1.png" width="480" /></p>
<ul>
<li>Add <strong>layers</strong> to that object to customize the plot:
<ul>
<li><strong>ggtitle</strong> to add a title</li>
<li><strong>geom_vline</strong> to add a vertical line</li>
<li>etc.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb524-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data=</span> df1 , <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>sample1, <span class="dt">y=</span>sample2)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb524-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb524-3" data-line-number="3"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="dt">label=</span><span class="st">&quot;my first ggplot&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb524-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="dv">0</span>)</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-303-1.png" width="480" /></p>
<p>Bookmark that <a href="https://ggplot2.tidyverse.org/reference/">ggplot2 reference</a> and that good <a href="https://www.rstudio.com/wp-content/uploads/2016/11/ggplot2-cheatsheet-2.1.pdf">cheatsheet</a> for some of the ggplot2 options.</p>
<ul>
<li>You can save the plot in an object <strong>at any time</strong> and add layers to that object:</li>
</ul>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb525-1" data-line-number="1"><span class="co"># Save in an object</span></a>
<a class="sourceLine" id="cb525-2" data-line-number="2">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span> df1 , <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>sample1, <span class="dt">y=</span>sample2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb525-3" data-line-number="3"><span class="st">    </span><span class="kw">geom_point</span>()</a>
<a class="sourceLine" id="cb525-4" data-line-number="4"><span class="co"># Add layers to that object</span></a>
<a class="sourceLine" id="cb525-5" data-line-number="5">p <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="dt">label=</span><span class="st">&quot;my first ggplot&quot;</span>)</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-304-1.png" width="480" /></p>
<ul>
<li>What is inside the <strong>aes</strong> (aesthetics)function ?
<ul>
<li>Anything that varies according to your data !
<ul>
<li>Columns with values to be plotted.</li>
<li>Columns with which you want to, for example, color the points.</li>
</ul></li>
</ul></li>
</ul>
<p>Color all points in red (not depending on the data):</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb526-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data=</span>df1 , <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>sample1, <span class="dt">y=</span>sample2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb526-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">color=</span><span class="st">&quot;red&quot;</span>) </a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-305-1.png" width="480" /></p>
<p>Color the points according to another column in the data frame:</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb527-1" data-line-number="1"><span class="co"># Build a data frame from df1: add a column with &quot;yes&quot; and &quot;no&quot;</span></a>
<a class="sourceLine" id="cb527-2" data-line-number="2">df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(df1, <span class="dt">grouping=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>), <span class="kw">c</span>(<span class="dv">80</span>, <span class="dv">120</span>)))</a>
<a class="sourceLine" id="cb527-3" data-line-number="3"></a>
<a class="sourceLine" id="cb527-4" data-line-number="4"><span class="co"># Plot and add the color parameter in the aes():</span></a>
<a class="sourceLine" id="cb527-5" data-line-number="5">pscat &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>df2, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>sample1, <span class="dt">y=</span>sample2, <span class="dt">color=</span>grouping)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb527-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
</div>
<div id="box-plots-1" class="section level2">
<h2><span class="header-section-number">19.3</span> Box plots</h2>
<ul>
<li>Simple boxplot showing the data distribution of sample 1:</li>
</ul>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb528-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data=</span>df2, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span><span class="st">&quot;&quot;</span>, <span class="dt">y=</span>sample1)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-307-1.png" width="480" /></p>
<ul>
<li>Split the data into 2 boxes:</li>
</ul>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb529-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data=</span>df2, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>grouping, <span class="dt">y=</span>sample1)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-308-1.png" width="480" /></p>
<ul>
<li>What if you want to plot both sample1 and sample2 ?<br>
<em>You need to convert into a <strong>long</strong> format</em></li>
</ul>
<p>Plotting both sample1 and sample2:</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb530-1" data-line-number="1"><span class="co"># install package reshape2</span></a>
<a class="sourceLine" id="cb530-2" data-line-number="2"><span class="kw">install.packages</span>(<span class="st">&quot;reshape2&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb531-1" data-line-number="1"><span class="co"># load package</span></a>
<a class="sourceLine" id="cb531-2" data-line-number="2"><span class="kw">library</span>(<span class="st">&quot;reshape2&quot;</span>)</a>
<a class="sourceLine" id="cb531-3" data-line-number="3"></a>
<a class="sourceLine" id="cb531-4" data-line-number="4"><span class="co"># convert to long format</span></a>
<a class="sourceLine" id="cb531-5" data-line-number="5">df_long &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="dt">data=</span>df2)</a>
<a class="sourceLine" id="cb531-6" data-line-number="6">    <span class="co"># all numeric values are organized into only one column: value</span></a>
<a class="sourceLine" id="cb531-7" data-line-number="7"><span class="co"># plot:</span></a>
<a class="sourceLine" id="cb531-8" data-line-number="8"><span class="kw">ggplot</span>(<span class="dt">data=</span>df_long, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>variable, <span class="dt">y=</span>value)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb531-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-310-1.png" width="480" /></p>
<ul>
<li>What if now you also want to see the distribution of “yes” and “no” in both sample1 and sample2 ?<br>
<em>Integrate a parameter to the <strong>aes()</strong></em></li>
</ul>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb532-1" data-line-number="1"><span class="co"># Either color (color of the box border)</span></a>
<a class="sourceLine" id="cb532-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="dt">data=</span>df_long, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>variable, <span class="dt">y=</span>value, <span class="dt">color=</span>grouping)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb532-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-311-1.png" width="480" /></p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb533-1" data-line-number="1"><span class="co"># Or fill (color inside the box)</span></a>
<a class="sourceLine" id="cb533-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="dt">data=</span>df_long, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>variable, <span class="dt">y=</span>value, <span class="dt">fill=</span>grouping)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb533-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-312-1.png" width="480" /></p>
<p>Do you want to change the default colors?<br>
* Integrate either layer:
* <strong>scale_color_manual()</strong>
* <strong>scale_fill_manual</strong></p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb534-1" data-line-number="1">pbox &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>df_long, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>variable, <span class="dt">y=</span>value, <span class="dt">fill=</span>grouping)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb534-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb534-3" data-line-number="3"><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;slateblue2&quot;</span>, <span class="st">&quot;chocolate&quot;</span>))</a></code></pre></div>
</div>
<div id="dot-plots" class="section level2">
<h2><span class="header-section-number">19.4</span> Dot plots</h2>
<p>Example of the expression of a gene in 6 samples: 2 experimental groups in triplicates.</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb535-1" data-line-number="1"><span class="co"># create a named vector with the expression of a gene</span></a>
<a class="sourceLine" id="cb535-2" data-line-number="2">mygene &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">8.1</span>, <span class="fl">8.2</span>, <span class="fl">8.6</span>, <span class="fl">8.7</span>, <span class="fl">9.4</span>, <span class="fl">8.5</span>)</a>
<a class="sourceLine" id="cb535-3" data-line-number="3"></a>
<a class="sourceLine" id="cb535-4" data-line-number="4"><span class="co"># the names of each element of the vector are sample names</span></a>
<a class="sourceLine" id="cb535-5" data-line-number="5"><span class="kw">names</span>(mygene) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;KO1&quot;</span>, <span class="st">&quot;KO2&quot;</span>, <span class="st">&quot;KO3&quot;</span>, <span class="st">&quot;WT1&quot;</span>, <span class="st">&quot;WT2&quot;</span>, <span class="st">&quot;WT3&quot;</span>)</a>
<a class="sourceLine" id="cb535-6" data-line-number="6"></a>
<a class="sourceLine" id="cb535-7" data-line-number="7"><span class="co"># transform to long format</span></a>
<a class="sourceLine" id="cb535-8" data-line-number="8">mygenelong &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="dt">data=</span>mygene)</a>
<a class="sourceLine" id="cb535-9" data-line-number="9"></a>
<a class="sourceLine" id="cb535-10" data-line-number="10"><span class="co"># add new columns containing sample names and experimental groups</span></a>
<a class="sourceLine" id="cb535-11" data-line-number="11">mygenelong<span class="op">$</span>sample_name &lt;-<span class="st"> </span><span class="kw">rownames</span>(mygenelong)</a>
<a class="sourceLine" id="cb535-12" data-line-number="12">mygenelong<span class="op">$</span>group &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;[1-3]{1}&quot;</span>, <span class="st">&quot;&quot;</span>, mygenelong<span class="op">$</span>sample_name)</a>
<a class="sourceLine" id="cb535-13" data-line-number="13"></a>
<a class="sourceLine" id="cb535-14" data-line-number="14"><span class="co"># dot plot</span></a>
<a class="sourceLine" id="cb535-15" data-line-number="15">  <span class="co"># add labels with &quot;label&quot; in the aes() and layer geom_text()</span></a>
<a class="sourceLine" id="cb535-16" data-line-number="16">  <span class="co"># nudge_x adjust the labels horizontally</span></a>
<a class="sourceLine" id="cb535-17" data-line-number="17">pdot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>mygenelong, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>group, <span class="dt">y=</span>value, <span class="dt">col=</span>group, <span class="dt">label=</span>sample_name)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb535-18" data-line-number="18"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb535-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">nudge_x=</span><span class="fl">0.2</span>)</a></code></pre></div>
<ul>
<li>Add more layers:
<ul>
<li><strong>xlab()</strong> to change the x axis label</li>
<li><strong>ylab()</strong> to change the y axis label</li>
<li><strong>theme</strong> to manage the legend</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb536-1" data-line-number="1">pdot <span class="op">+</span><span class="st">  </span><span class="kw">xlab</span>(<span class="dt">label=</span><span class="st">&quot;Experimental group&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb536-2" data-line-number="2"><span class="st">  </span><span class="kw">ylab</span>(<span class="dt">label=</span><span class="st">&quot;Normalized expression (log2)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb536-3" data-line-number="3"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="dt">label=</span><span class="st">&quot;Expression of gene 1&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb536-4" data-line-number="4"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb536-5" data-line-number="5"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-315-1.png" width="480" /></p>
</div>
<div id="bar-plots-1" class="section level2">
<h2><span class="header-section-number">19.5</span> Bar plots</h2>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb537-1" data-line-number="1"><span class="co"># A simple bar plot</span></a>
<a class="sourceLine" id="cb537-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="dt">data=</span>df2, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>grouping)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-316-1.png" width="480" /></p>
<ul>
<li>Customize:
<ul>
<li><strong>scale_x_discrete</strong> is used to handle x-axis title and labels</li>
<li><strong>coord_flip</strong> swaps the x and y axis</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb538-1" data-line-number="1"><span class="co"># Save the plot in the object &quot;p&quot;</span></a>
<a class="sourceLine" id="cb538-2" data-line-number="2">pbar &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>df2, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>grouping, <span class="dt">fill=</span>grouping)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb538-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_bar</span>()</a>
<a class="sourceLine" id="cb538-4" data-line-number="4"></a>
<a class="sourceLine" id="cb538-5" data-line-number="5"><span class="co"># Change x axis label with scale_x_discrete and change order of the bars:</span></a>
<a class="sourceLine" id="cb538-6" data-line-number="6">p2 &lt;-<span class="st"> </span>pbar <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">name=</span><span class="st">&quot;counts of yes / no&quot;</span>, <span class="dt">limits=</span><span class="kw">c</span>(<span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>))</a>
<a class="sourceLine" id="cb538-7" data-line-number="7"></a>
<a class="sourceLine" id="cb538-8" data-line-number="8"><span class="co"># Swapping x and y axis with coord_flip():</span></a>
<a class="sourceLine" id="cb538-9" data-line-number="9">p3 &lt;-<span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</a>
<a class="sourceLine" id="cb538-10" data-line-number="10"></a>
<a class="sourceLine" id="cb538-11" data-line-number="11"><span class="co"># Change fill</span></a>
<a class="sourceLine" id="cb538-12" data-line-number="12">p4 &lt;-<span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;cyan&quot;</span>))</a>
<a class="sourceLine" id="cb538-13" data-line-number="13"></a>
<a class="sourceLine" id="cb538-14" data-line-number="14"><span class="co"># Show intermediary and final plots</span></a>
<a class="sourceLine" id="cb538-15" data-line-number="15">pbar</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-317-1.png" width="480" /></p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb539-1" data-line-number="1">p2</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-317-2.png" width="480" /></p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb540-1" data-line-number="1">p3</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-317-3.png" width="480" /></p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb541-1" data-line-number="1">p4</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-317-4.png" width="480" /></p>
</div>
<div id="histograms-1" class="section level2">
<h2><span class="header-section-number">19.6</span> Histograms</h2>
<p>Simple histogram on one sample (using the df2 data frame):</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb542-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data=</span>df1, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>sample1)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-318-1.png" width="480" /></p>
<p>Histogram on more samples (using df_long):</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb543-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data=</span>df_long, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>value)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-319-1.png" width="480" /></p>
<p>Split the data per sample (“variable” column that represents here the samples):</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb544-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data=</span>df_long, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>value, <span class="dt">fill=</span>variable)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-320-1.png" width="480" /></p>
<p>By default, the histograms are <strong>stacked</strong>: change to position <strong>dodge</strong> (side by side):</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb545-1" data-line-number="1">phist &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>df_long, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>value, <span class="dt">fill=</span>variable)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb545-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">position=</span><span class="st">&#39;dodge&#39;</span>)</a></code></pre></div>
</div>
<div id="about-themes" class="section level2">
<h2><span class="header-section-number">19.7</span> About themes</h2>
<p>You can change the default global <strong>theme</strong> (background color, grid lines etc. all non-data display):</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb546-1" data-line-number="1"><span class="co"># go back to a previous plot</span></a>
<a class="sourceLine" id="cb546-2" data-line-number="2">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>df_long, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>value)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>()</a>
<a class="sourceLine" id="cb546-3" data-line-number="3"></a>
<a class="sourceLine" id="cb546-4" data-line-number="4"><span class="co"># Try different themes</span></a>
<a class="sourceLine" id="cb546-5" data-line-number="5">p <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-322-1.png" width="480" /></p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb547-1" data-line-number="1">p <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-322-2.png" width="480" /></p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb548-1" data-line-number="1">p <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-322-3.png" width="480" /></p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb549-1" data-line-number="1">p <span class="op">+</span><span class="st"> </span><span class="kw">theme_grey</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-322-4.png" width="480" /></p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb550-1" data-line-number="1">p <span class="op">+</span><span class="st"> </span><span class="kw">theme_dark</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-322-5.png" width="480" /></p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb551-1" data-line-number="1">p <span class="op">+</span><span class="st"> </span><span class="kw">theme_light</span>() </a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-322-6.png" width="480" /></p>
</div>
<div id="saving-plots-in-files" class="section level2">
<h2><span class="header-section-number">19.8</span> Saving plots in files</h2>
<ul>
<li>The same as for regular plots applies:</li>
</ul>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb552-1" data-line-number="1"><span class="kw">png</span>(<span class="st">&quot;myggplot.png&quot;</span>)</a>
<a class="sourceLine" id="cb552-2" data-line-number="2">p</a>
<a class="sourceLine" id="cb552-3" data-line-number="3"><span class="kw">dev.off</span>()</a></code></pre></div>
<ul>
<li>You can also use the ggplot2 <strong>ggsave</strong> function:</li>
</ul>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb553-1" data-line-number="1"><span class="co"># By default, save the last plot that was produced</span></a>
<a class="sourceLine" id="cb553-2" data-line-number="2"><span class="kw">ggsave</span>(<span class="dt">filename=</span><span class="st">&quot;lastplot.png&quot;</span>)</a>
<a class="sourceLine" id="cb553-3" data-line-number="3"></a>
<a class="sourceLine" id="cb553-4" data-line-number="4"><span class="co"># You can pick which plot you want to save:</span></a>
<a class="sourceLine" id="cb553-5" data-line-number="5"><span class="kw">ggsave</span>(<span class="dt">filename=</span><span class="st">&quot;myplot.png&quot;</span>, <span class="dt">plot=</span>p)</a>
<a class="sourceLine" id="cb553-6" data-line-number="6"></a>
<a class="sourceLine" id="cb553-7" data-line-number="7"><span class="co"># Many different formats are available: </span></a>
<a class="sourceLine" id="cb553-8" data-line-number="8">  <span class="co"># &quot;eps&quot;, &quot;ps&quot;, &quot;tex&quot;, &quot;pdf&quot;, &quot;jpeg&quot;, &quot;tiff&quot;, &quot;png&quot;, &quot;bmp&quot;, &quot;svg&quot;, &quot;wmf&quot;</span></a>
<a class="sourceLine" id="cb553-9" data-line-number="9"><span class="kw">ggsave</span>(<span class="dt">filename=</span><span class="st">&quot;myplot.ps&quot;</span>, <span class="dt">plot=</span>p, <span class="dt">device=</span><span class="st">&quot;ps&quot;</span>)</a>
<a class="sourceLine" id="cb553-10" data-line-number="10"></a>
<a class="sourceLine" id="cb553-11" data-line-number="11"><span class="co"># Change the height and width (and their unit):</span></a>
<a class="sourceLine" id="cb553-12" data-line-number="12"><span class="kw">ggsave</span>(<span class="dt">filename=</span><span class="st">&quot;myplot.pdf&quot;</span>, </a>
<a class="sourceLine" id="cb553-13" data-line-number="13">  <span class="dt">width =</span> <span class="dv">20</span>, </a>
<a class="sourceLine" id="cb553-14" data-line-number="14">  <span class="dt">height =</span> <span class="dv">20</span>, </a>
<a class="sourceLine" id="cb553-15" data-line-number="15">  <span class="dt">units =</span> <span class="st">&quot;cm&quot;</span>)</a></code></pre></div>
<ul>
<li>You can also organize several plots on one page
<ul>
<li>One way is to use the <strong>gridExtra</strong> package:</li>
<li>ncol, nrow: arrange plots in such number of columns and rows</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb554-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">&quot;gridExtra&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb555-1" data-line-number="1"><span class="co"># load package</span></a>
<a class="sourceLine" id="cb555-2" data-line-number="2"><span class="kw">library</span>(gridExtra)</a>
<a class="sourceLine" id="cb555-3" data-line-number="3"><span class="co"># 2 rows and 2 columns</span></a>
<a class="sourceLine" id="cb555-4" data-line-number="4"><span class="kw">grid.arrange</span>(pscat, pbox, pbar, phist, <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-326-1.png" width="480" /></p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb556-1" data-line-number="1"><span class="co"># 1 row and 4 columns</span></a>
<a class="sourceLine" id="cb556-2" data-line-number="2"><span class="kw">grid.arrange</span>(pscat, pbox, pbar, phist, <span class="dt">nrow=</span><span class="dv">1</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-327-1.png" width="960" /></p>
<p><strong>WARNING !!</strong>: ggsave and grid.arrange are not directly compatible. To save a file organized by grid.arrange, use the regular functions (pdf, png etc.)</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb557-1" data-line-number="1"><span class="kw">jpeg</span>(<span class="st">&quot;grid_arrange_plots.jpg&quot;</span>)</a>
<a class="sourceLine" id="cb557-2" data-line-number="2"><span class="kw">grid.arrange</span>(pscat, pbox, pbar, phist, <span class="dt">nrow=</span><span class="dv">1</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb557-3" data-line-number="3"><span class="kw">dev.off</span>()</a></code></pre></div>

</div>
<div id="exercise-12-ggplot2" class="section level2">
<h2><span class="header-section-number">19.9</span> Exercise 12: ggplot2</h2>
<p>Create the script “exercise12.R” and save it to the “Rcourse/Module3” directory: you will save all the commands of exercise 12 in that script.
<br>Remember you can comment the code using #.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb558-1" data-line-number="1"><span class="kw">getwd</span>()</a>
<a class="sourceLine" id="cb558-2" data-line-number="2"><span class="kw">setwd</span>(<span class="st">&quot;~/Rcourse/Module3&quot;</span>)</a></code></pre></div>
</details>
<div id="exercise-12a--scatter-plot" class="section level3">
<h3><span class="header-section-number">19.9.1</span> Exercise 12a- Scatter plot</h3>
<p><strong>1- Load ggplot2 package</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb559-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a></code></pre></div>
</details>
<p><strong>2- Download the data we will use for plotting:</strong></p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb560-1" data-line-number="1"><span class="kw">download.file</span>(<span class="st">&quot;https://raw.githubusercontent.com/sarahbonnin/CRG_RIntroduction/master/ex12_normalized_intensities.csv&quot;</span>, <span class="st">&quot;ex12_normalized_intensities.csv&quot;</span>, <span class="dt">method=</span><span class="st">&quot;curl&quot;</span>)</a></code></pre></div>
<p><strong>3- Read file into object “project1”</strong></p>
<p>About this file:
* It is comma separated (csv format)
* The first row is the header
* Take the row names from the first column</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb561-1" data-line-number="1">project1 &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;ex12_normalized_intensities.csv&quot;</span>, </a>
<a class="sourceLine" id="cb561-2" data-line-number="2">  <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>, </a>
<a class="sourceLine" id="cb561-3" data-line-number="3">  <span class="dt">header=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb561-4" data-line-number="4">  <span class="dt">row.names =</span> <span class="dv">1</span>)</a></code></pre></div>
</details>
<p><strong>4- Using ggplot, create a simple scatter plot representing gene expression of “sampleB” on the x-axis and “sampleH” on the y-axis.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb562-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data=</span>project1, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>sampleB, <span class="dt">y=</span>sampleH)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb562-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-333-1.png" width="480" /></p>
</details>
<p><strong>5- Create an extra column to the data frame “project1” (you can call this column “expr_limits”): if the expression of a gene is &gt; 13 in both sampleB and sampleH, set to “high”; if the expression of a gene is &lt; 6 in both sampleB and sampleH, set to “low”; if different, set to “normal”.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb563-1" data-line-number="1"><span class="co"># Initialize all values to &quot;normal&quot;</span></a>
<a class="sourceLine" id="cb563-2" data-line-number="2">project1<span class="op">$</span>expr_limits &lt;-<span class="st"> &quot;normal&quot;</span></a>
<a class="sourceLine" id="cb563-3" data-line-number="3"><span class="co"># &quot;high&quot; if project1$sampleB &gt; 13 and project1$sampleH &gt; 13</span></a>
<a class="sourceLine" id="cb563-4" data-line-number="4">project1<span class="op">$</span>expr_limits[project1<span class="op">$</span>sampleB <span class="op">&gt;</span><span class="st"> </span><span class="dv">13</span> <span class="op">&amp;</span><span class="st"> </span>project1<span class="op">$</span>sampleH <span class="op">&gt;</span><span class="st"> </span><span class="dv">13</span>] &lt;-<span class="st"> &quot;high&quot;</span></a>
<a class="sourceLine" id="cb563-5" data-line-number="5"><span class="co"># &quot;low&quot; if project1$sampleB &lt; 6 and project1$sampleH &lt; 6</span></a>
<a class="sourceLine" id="cb563-6" data-line-number="6">project1<span class="op">$</span>expr_limits[project1<span class="op">$</span>sampleB <span class="op">&lt;</span><span class="st"> </span><span class="dv">6</span> <span class="op">&amp;</span><span class="st"> </span>project1<span class="op">$</span>sampleH <span class="op">&lt;</span><span class="st"> </span><span class="dv">6</span>] &lt;-<span class="st"> &quot;low&quot;</span></a></code></pre></div>
</details>
<p><strong>6- Color the points of your scatter plot according to the newly created column “expr_limits”. Save that plot in the object “p”</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb564-1" data-line-number="1">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>project1, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>sampleB, <span class="dt">y=</span>sampleH, <span class="dt">color=</span>expr_limits)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb564-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
</details>
<p><strong>7- Add a layer to “p” in order to change the points colors to blue (for low), grey (for normal) and red (for high). Save this plot in the object “p2”.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb565-1" data-line-number="1">p2 &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;grey&quot;</span>))</a></code></pre></div>
</details>
<p><strong>8- Save p2 in a jpeg file.</strong>
a. Try with RStudio Plots window (Export)<br>
b. Try in the console:<br></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb566-1" data-line-number="1"><span class="kw">jpeg</span>(<span class="st">&quot;myscatterggplot.jpg&quot;</span>)</a>
<a class="sourceLine" id="cb566-2" data-line-number="2">  p2</a>
<a class="sourceLine" id="cb566-3" data-line-number="3"><span class="kw">dev.off</span>()</a></code></pre></div>
<pre><code>## png 
##   2</code></pre>
</details>
</div>
<div id="exercise-12b--box-plot" class="section level3">
<h3><span class="header-section-number">19.9.2</span> Exercise 12b- Box plot</h3>
<p><strong>1- Convert “project1” from a wide format to a long format: save in the object “project_long”</strong>
<em>Note: remember melt function from reshape2 package.</em></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb568-1" data-line-number="1"><span class="kw">library</span>(reshape2)</a>
<a class="sourceLine" id="cb568-2" data-line-number="2">project_long &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="dt">data=</span>project1)</a></code></pre></div>
</details>
<p><strong>2- Produce a boxplot of the expression of all samples (each sample should be represented by a box)</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb569-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data=</span>project_long, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>variable, <span class="dt">y=</span>value)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb569-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-339-1.png" width="480" /></p>
</details>
<p><strong>3- Modify the previous boxplot so as to obtain 3 “sub-boxplots”&quot; per sample, each representing the expression of either “low”, “normal” or “high” genes.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb570-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data=</span>project_long, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>variable, <span class="dt">y=</span>value, <span class="dt">color=</span>expr_limits)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb570-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-340-1.png" width="480" /></p>
</details>
<p><strong>4- Rotate the x-axis labels (90 degrees angle).</strong>
<br>
This is new ! Google it !!</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb571-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data=</span>project_long, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>variable, <span class="dt">y=</span>value, <span class="dt">color=</span>expr_limits)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb571-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb571-3" data-line-number="3"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>))</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-341-1.png" width="480" /></p>
</details>
<p><strong>5- Finally, add a title to the plot.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb572-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data=</span>project_long, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>variable, <span class="dt">y=</span>value, <span class="dt">color=</span>expr_limits)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb572-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb572-3" data-line-number="3"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb572-4" data-line-number="4"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;My boxplots&quot;</span>)</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-342-1.png" width="480" /></p>
</details>
</div>
<div id="exercise-12c--bar-plot" class="section level3">
<h3><span class="header-section-number">19.9.3</span> Exercise 12c- Bar plot</h3>
<p><strong>1- Produce a bar plot of how many low/normal/high genes are in the column “expr_limits” of “project1”.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb573-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data=</span>project1, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>expr_limits)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb573-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_bar</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-343-1.png" width="480" /></p>
</details>
<p><strong>2- Add an horizontal line at counts 250 (y-axis). Save the plot in the object “bar”</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb574-1" data-line-number="1">bar &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>project1, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>expr_limits)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb574-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb574-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">250</span>)</a></code></pre></div>
</details>
<p><strong>3- Swap the x and y axis. Save in bar2.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb575-1" data-line-number="1">bar2 &lt;-<span class="st"> </span>bar <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</a></code></pre></div>
</details>
<p><strong>4- Save “bar” and “bar2” plots in a “png” file, using the </strong>png()** function: use grid.arrange (from the gridExtra package) to organize both plots in one page !**</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb576-1" data-line-number="1"><span class="kw">png</span>(<span class="st">&quot;mybarplots.png&quot;</span>, <span class="dt">width=</span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb576-2" data-line-number="2"><span class="kw">grid.arrange</span>(bar, bar2, <span class="dt">nrow=</span><span class="dv">1</span>, <span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb576-3" data-line-number="3"><span class="kw">dev.off</span>()</a></code></pre></div>
<pre><code>## png 
##   2</code></pre>
</details>
</div>
<div id="exercise-12d--histogram" class="section level3">
<h3><span class="header-section-number">19.9.4</span> Exercise 12d- Histogram</h3>
<p><strong>1- Create a simple histogram using project_long (column “value”).</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb578-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data=</span>project_long, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>value)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb578-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_histogram</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-347-1.png" width="480" /></p>
</details>
<p><strong>2- Notice that you get the following warning message&quot; <em>stat_bin() using <code>bins = 30</code>. Pick better value with <code>binwidth</code>.</em></strong><br>
Set “bins”&quot; parameter of geom_histogram() to 50.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb579-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data=</span>project_long, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>value)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb579-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">50</span>)</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-348-1.png" width="480" /></p>
</details>
<p><strong>3- This histogram plots expression values for </strong>All samples<strong>.</strong>
<br>
Change the plot so as to obtain one histograms per sample.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb580-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data=</span>project_long, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>value, <span class="dt">fill=</span>variable)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb580-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">50</span>)</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-349-1.png" width="480" /></p>
</details>
<p><strong>4- By default, geom_histogram produces a stacked histogram.</strong>
<br>
Change the “position” argument to “dodge”.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb581-1" data-line-number="1">hist1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>project_long, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>value, <span class="dt">fill=</span>variable)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb581-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>)</a></code></pre></div>
</details>
<p><strong>5- A bit messy ?? Run the following:</strong></p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb582-1" data-line-number="1">hist2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>project_long, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>value, <span class="dt">fill=</span>variable)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb582-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">50</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb582-3" data-line-number="3"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span>variable)</a></code></pre></div>
<p><strong>facet_grid()</strong> is another easy way to split the views!</p>
<p><strong>6- Change the default colors with scale_fill_manual().</strong>
<br>
You can try the rainbow() function for coloring.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb583-1" data-line-number="1">hist3 &lt;-<span class="st"> </span>hist2 <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">rainbow</span>(<span class="dv">8</span>))</a></code></pre></div>
</details>
<p><strong>7- Zoom in the plots: set the x-axis limits from from 6 to 13.</strong>
<br>
Add the <strong>xlim()</strong> layer.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb584-1" data-line-number="1">hist4 &lt;-<span class="st"> </span>hist3 <span class="op">+</span><span class="st"> </span><span class="kw">xlim</span>(<span class="dv">6</span>, <span class="dv">13</span>)</a></code></pre></div>
</details>
<p><strong>8- Change the default theme to theme_minimal()</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb585-1" data-line-number="1">hist5 &lt;-<span class="st"> </span>hist4 <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
</details>
<p><strong>9- Save that last plot to a file (format of your choice) with ggsave()</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb586-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="dt">filename=</span><span class="st">&quot;myhistograms.png&quot;</span>, <span class="dt">plot=</span>hist5, <span class="dt">device=</span><span class="st">&quot;png&quot;</span>, <span class="dt">width=</span><span class="dv">20</span>)</a></code></pre></div>
</details>

</div>
</div>
<div id="more-about-the-theme-function" class="section level2">
<h2><span class="header-section-number">19.10</span> More about the theme() function</h2>
<p>The <strong>theme()</strong> allows a precise control of graphical parameters such as axis text, ticks and labels, or legend texts and labels, etc.
<br>
More details <a href="https://ggplot2.tidyverse.org/reference/theme.html">here</a></p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb587-1" data-line-number="1"><span class="co"># Let&#39;s the project_long object from exercise 12, and plot boxplots</span></a>
<a class="sourceLine" id="cb587-2" data-line-number="2">boxp &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>project_long, <span class="kw">aes</span>(<span class="dt">x=</span>variable, <span class="dt">y=</span>value, <span class="dt">color=</span>expr_limits)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb587-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_boxplot</span>()</a>
<a class="sourceLine" id="cb587-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb587-5" data-line-number="5"><span class="co"># Remove the legend title:</span></a>
<a class="sourceLine" id="cb587-6" data-line-number="6">boxp <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.title=</span><span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-356-1.png" width="480" /></p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb588-1" data-line-number="1"><span class="co"># Change font of legend text</span></a>
<a class="sourceLine" id="cb588-2" data-line-number="2">boxp <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.title=</span><span class="kw">element_blank</span>(), </a>
<a class="sourceLine" id="cb588-3" data-line-number="3">  <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-356-2.png" width="480" /></p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb589-1" data-line-number="1"><span class="co"># Put legend on the top of the plot</span></a>
<a class="sourceLine" id="cb589-2" data-line-number="2">boxp <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.title=</span><span class="kw">element_blank</span>(), </a>
<a class="sourceLine" id="cb589-3" data-line-number="3">  <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb589-4" data-line-number="4">  <span class="dt">legend.position=</span><span class="st">&quot;top&quot;</span>)</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-356-3.png" width="480" /></p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb590-1" data-line-number="1"><span class="co"># Rotate x-axis labels</span></a>
<a class="sourceLine" id="cb590-2" data-line-number="2">boxp <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.title=</span><span class="kw">element_blank</span>(), </a>
<a class="sourceLine" id="cb590-3" data-line-number="3">  <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb590-4" data-line-number="4">  <span class="dt">legend.position=</span><span class="st">&quot;top&quot;</span>,</a>
<a class="sourceLine" id="cb590-5" data-line-number="5">  <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>))</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-356-4.png" width="480" /></p>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb591-1" data-line-number="1"><span class="co"># Add a color to the plot&#39;s background</span></a>
<a class="sourceLine" id="cb591-2" data-line-number="2">boxp <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.title=</span><span class="kw">element_blank</span>(), </a>
<a class="sourceLine" id="cb591-3" data-line-number="3">  <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb591-4" data-line-number="4">  <span class="dt">legend.position=</span><span class="st">&quot;top&quot;</span>,</a>
<a class="sourceLine" id="cb591-5" data-line-number="5">  <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),</a>
<a class="sourceLine" id="cb591-6" data-line-number="6">  <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;yellow&quot;</span>))</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-356-5.png" width="480" /></p>
</div>
<div id="volcano-plots" class="section level2">
<h2><span class="header-section-number">19.11</span> Volcano plots</h2>
<p>A volcano plot is a type of scatter plot represents differential expression of features (genes for example): on the x-axis we typically find the fold change and on the y-axis the p-value.
<br></p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb592-1" data-line-number="1"><span class="co"># Download the data we will use for plotting</span></a>
<a class="sourceLine" id="cb592-2" data-line-number="2"><span class="kw">download.file</span>(<span class="st">&quot;https://raw.githubusercontent.com/sarahbonnin/CRG_RIntroduction/master/de_df_for_volcano.rds&quot;</span>, <span class="st">&quot;de_df_for_volcano.rds&quot;</span>, <span class="dt">method=</span><span class="st">&quot;curl&quot;</span>)</a>
<a class="sourceLine" id="cb592-3" data-line-number="3"></a>
<a class="sourceLine" id="cb592-4" data-line-number="4"><span class="co"># The RDS format is used to save a single R object to a file, and to restore it.</span></a>
<a class="sourceLine" id="cb592-5" data-line-number="5"><span class="co"># Extract that object in the current session:</span></a>
<a class="sourceLine" id="cb592-6" data-line-number="6">tmp &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;de_df_for_volcano.rds&quot;</span>)</a>
<a class="sourceLine" id="cb592-7" data-line-number="7"></a>
<a class="sourceLine" id="cb592-8" data-line-number="8"><span class="co"># remove rows that contain NA values</span></a>
<a class="sourceLine" id="cb592-9" data-line-number="9">de &lt;-<span class="st"> </span>tmp[<span class="kw">complete.cases</span>(tmp), ]</a></code></pre></div>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb593-1" data-line-number="1"><span class="co"># The basic scatter plot: x is &quot;log2FoldChange&quot;, y is &quot;pvalue&quot;</span></a>
<a class="sourceLine" id="cb593-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="dt">data=</span>de, <span class="kw">aes</span>(<span class="dt">x=</span>log2FoldChange, <span class="dt">y=</span>pvalue)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-358-1.png" width="480" /></p>
<p>Doesn’t look quite like a Volcano plot…<br>
Convert the p-value into a -log10(p-value)</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb594-1" data-line-number="1"><span class="co"># Convert directly in the aes()</span></a>
<a class="sourceLine" id="cb594-2" data-line-number="2">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>de, <span class="kw">aes</span>(<span class="dt">x=</span>log2FoldChange, <span class="dt">y=</span><span class="op">-</span><span class="kw">log10</span>(pvalue))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb595-1" data-line-number="1"><span class="co"># Add more simple &quot;theme&quot;</span></a>
<a class="sourceLine" id="cb595-2" data-line-number="2">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>de, <span class="kw">aes</span>(<span class="dt">x=</span>log2FoldChange, <span class="dt">y=</span><span class="op">-</span><span class="kw">log10</span>(pvalue))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb596-1" data-line-number="1"><span class="co"># Add vertical lines for log2FoldChange thresholds, and one horizontal line for the p-value threshold </span></a>
<a class="sourceLine" id="cb596-2" data-line-number="2">p2 &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.6</span>, <span class="fl">0.6</span>), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb596-3" data-line-number="3"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="op">-</span><span class="kw">log10</span>(<span class="fl">0.05</span>), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb597-1" data-line-number="1"><span class="co"># The significantly differentially expressed genes are the ones found in the upper-left and upper-right corners.</span></a>
<a class="sourceLine" id="cb597-2" data-line-number="2"><span class="co"># Add a column to the data frame to specify if they are UP- or DOWN- regulated (log2FoldChange respectively positive or negative)</span></a>
<a class="sourceLine" id="cb597-3" data-line-number="3"></a>
<a class="sourceLine" id="cb597-4" data-line-number="4"><span class="co"># add a column of NAs</span></a>
<a class="sourceLine" id="cb597-5" data-line-number="5">de<span class="op">$</span>diffexpressed &lt;-<span class="st"> &quot;NO&quot;</span></a>
<a class="sourceLine" id="cb597-6" data-line-number="6"><span class="co"># if log2Foldchange &gt; 0.6 and pvalue &lt; 0.05, set as &quot;UP&quot; </span></a>
<a class="sourceLine" id="cb597-7" data-line-number="7">de<span class="op">$</span>diffexpressed[de<span class="op">$</span>log2FoldChange <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.6</span> <span class="op">&amp;</span><span class="st"> </span>de<span class="op">$</span>pvalue <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;UP&quot;</span></a>
<a class="sourceLine" id="cb597-8" data-line-number="8"><span class="co"># if log2Foldchange &lt; -0.6 and pvalue &lt; 0.05, set as &quot;DOWN&quot;</span></a>
<a class="sourceLine" id="cb597-9" data-line-number="9">de<span class="op">$</span>diffexpressed[de<span class="op">$</span>log2FoldChange <span class="op">&lt;</span><span class="st"> </span><span class="fl">-0.6</span> <span class="op">&amp;</span><span class="st"> </span>de<span class="op">$</span>pvalue <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;DOWN&quot;</span></a>
<a class="sourceLine" id="cb597-10" data-line-number="10"></a>
<a class="sourceLine" id="cb597-11" data-line-number="11"><span class="co"># Re-plot but this time color the points with &quot;diffexpressed&quot;</span></a>
<a class="sourceLine" id="cb597-12" data-line-number="12">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>de, <span class="kw">aes</span>(<span class="dt">x=</span>log2FoldChange, <span class="dt">y=</span><span class="op">-</span><span class="kw">log10</span>(pvalue), <span class="dt">col=</span>diffexpressed)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>()</a>
<a class="sourceLine" id="cb597-13" data-line-number="13"></a>
<a class="sourceLine" id="cb597-14" data-line-number="14"><span class="co"># Add lines as before...</span></a>
<a class="sourceLine" id="cb597-15" data-line-number="15">p2 &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.6</span>, <span class="fl">0.6</span>), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb597-16" data-line-number="16"><span class="st">        </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="op">-</span><span class="kw">log10</span>(<span class="fl">0.05</span>), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb598-1" data-line-number="1"><span class="co">## Change point color </span></a>
<a class="sourceLine" id="cb598-2" data-line-number="2"></a>
<a class="sourceLine" id="cb598-3" data-line-number="3"><span class="co"># 1. by default, it is assigned to the categories in an alphabetical order):</span></a>
<a class="sourceLine" id="cb598-4" data-line-number="4">p3 &lt;-<span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>))</a>
<a class="sourceLine" id="cb598-5" data-line-number="5"></a>
<a class="sourceLine" id="cb598-6" data-line-number="6"><span class="co"># 2. to automate a bit: ceate a named vector: the values are the colors to be used, the names are the categories they will be assigned to:</span></a>
<a class="sourceLine" id="cb598-7" data-line-number="7">mycolors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>)</a>
<a class="sourceLine" id="cb598-8" data-line-number="8"><span class="kw">names</span>(mycolors) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;DOWN&quot;</span>, <span class="st">&quot;UP&quot;</span>, <span class="st">&quot;NO&quot;</span>)</a>
<a class="sourceLine" id="cb598-9" data-line-number="9">p3 &lt;-<span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> mycolors)</a></code></pre></div>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb599-1" data-line-number="1"><span class="co"># Now write down the name of genes beside the points...</span></a>
<a class="sourceLine" id="cb599-2" data-line-number="2"><span class="co"># Create a new column &quot;delabel&quot; to de, that will contain the name of genes differentially expressed (NA in case they are not)</span></a>
<a class="sourceLine" id="cb599-3" data-line-number="3">de<span class="op">$</span>delabel &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb599-4" data-line-number="4">de<span class="op">$</span>delabel[de<span class="op">$</span>diffexpressed <span class="op">!=</span><span class="st"> &quot;NO&quot;</span>] &lt;-<span class="st"> </span>de<span class="op">$</span>gene_symbol[de<span class="op">$</span>diffexpressed <span class="op">!=</span><span class="st"> &quot;NO&quot;</span>]</a>
<a class="sourceLine" id="cb599-5" data-line-number="5"></a>
<a class="sourceLine" id="cb599-6" data-line-number="6"><span class="kw">ggplot</span>(<span class="dt">data=</span>de, <span class="kw">aes</span>(<span class="dt">x=</span>log2FoldChange, <span class="dt">y=</span><span class="op">-</span><span class="kw">log10</span>(pvalue), <span class="dt">col=</span>diffexpressed, <span class="dt">label=</span>delabel)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb599-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb599-8" data-line-number="8"><span class="st">    </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb599-9" data-line-number="9"><span class="st">    </span><span class="kw">geom_text</span>()</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-364-1.png" width="480" /></p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb600-1" data-line-number="1"><span class="co"># Finally, we can organize the labels nicely using the &quot;ggrepel&quot; package and the geom_text_repel() function</span></a>
<a class="sourceLine" id="cb600-2" data-line-number="2"><span class="co"># load library</span></a>
<a class="sourceLine" id="cb600-3" data-line-number="3"><span class="kw">library</span>(ggrepel)</a>
<a class="sourceLine" id="cb600-4" data-line-number="4"><span class="co"># plot adding up all layers we have seen so far</span></a>
<a class="sourceLine" id="cb600-5" data-line-number="5"><span class="kw">ggplot</span>(<span class="dt">data=</span>de, <span class="kw">aes</span>(<span class="dt">x=</span>log2FoldChange, <span class="dt">y=</span><span class="op">-</span><span class="kw">log10</span>(pvalue), <span class="dt">col=</span>diffexpressed, <span class="dt">label=</span>delabel)) <span class="op">+</span></a>
<a class="sourceLine" id="cb600-6" data-line-number="6"><span class="st">        </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb600-7" data-line-number="7"><span class="st">        </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb600-8" data-line-number="8"><span class="st">        </span><span class="kw">geom_text_repel</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb600-9" data-line-number="9"><span class="st">        </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb600-10" data-line-number="10"><span class="st">        </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.6</span>, <span class="fl">0.6</span>), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb600-11" data-line-number="11"><span class="st">        </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="op">-</span><span class="kw">log10</span>(<span class="fl">0.05</span>), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-365-1.png" width="480" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="plots-from-other-packages.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["r-intro-crg.pdf", "r-intro-crg.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
