<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Part9 Data structures | Introduction to R</title>
  <meta name="description" content="Part9 Data structures | Introduction to R" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Part9 Data structures | Introduction to R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Part9 Data structures | Introduction to R" />
  
  
  

<meta name="author" content="Sarah Bonnin" />


<meta name="date" content="2019-08-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-types.html"/>
<link rel="next" href="missing-values.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a></li>
<li class="chapter" data-level="2" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i><b>2</b> What is R ?</a></li>
<li class="chapter" data-level="3" data-path="what-is-rstudio.html"><a href="what-is-rstudio.html"><i class="fa fa-check"></i><b>3</b> What is RStudio ?</a><ul>
<li class="chapter" data-level="3.1" data-path="what-is-rstudio.html"><a href="what-is-rstudio.html#rstudio-access"><i class="fa fa-check"></i><b>3.1</b> RStudio access</a></li>
<li class="chapter" data-level="3.2" data-path="what-is-rstudio.html"><a href="what-is-rstudio.html#rstudio-interface"><i class="fa fa-check"></i><b>3.2</b> RStudio interface</a></li>
<li class="chapter" data-level="3.3" data-path="what-is-rstudio.html"><a href="what-is-rstudio.html#setting-up-the-folder-structure-for-the-course"><i class="fa fa-check"></i><b>3.3</b> Setting up the folder structure for the course</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="paths-and-directories.html"><a href="paths-and-directories.html"><i class="fa fa-check"></i><b>4</b> Paths and directories</a><ul>
<li class="chapter" data-level="4.1" data-path="paths-and-directories.html"><a href="paths-and-directories.html#tree-of-directories"><i class="fa fa-check"></i><b>4.1</b> Tree of directories</a></li>
<li class="chapter" data-level="4.2" data-path="paths-and-directories.html"><a href="paths-and-directories.html#navigate-the-tree-of-directory-with-the-r-terminal"><i class="fa fa-check"></i><b>4.2</b> Navigate the tree of directory with the R terminal</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>5</b> R basics</a><ul>
<li class="chapter" data-level="5.1" data-path="r-basics.html"><a href="r-basics.html#arithmetic-operators"><i class="fa fa-check"></i><b>5.1</b> Arithmetic operators</a></li>
<li class="chapter" data-level="5.2" data-path="r-basics.html"><a href="r-basics.html#simple-calculations"><i class="fa fa-check"></i><b>5.2</b> Simple calculations</a></li>
<li class="chapter" data-level="5.3" data-path="r-basics.html"><a href="r-basics.html#objects-in-r"><i class="fa fa-check"></i><b>5.3</b> Objects in R</a></li>
<li class="chapter" data-level="5.4" data-path="r-basics.html"><a href="r-basics.html#assignment-operators"><i class="fa fa-check"></i><b>5.4</b> Assignment operators</a></li>
<li class="chapter" data-level="5.5" data-path="r-basics.html"><a href="r-basics.html#assigning-data-to-an-object"><i class="fa fa-check"></i><b>5.5</b> Assigning data to an object</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>6</b> Functions</a></li>
<li class="chapter" data-level="7" data-path="r-scripts.html"><a href="r-scripts.html"><i class="fa fa-check"></i><b>7</b> R scripts</a><ul>
<li class="chapter" data-level="7.1" data-path="r-scripts.html"><a href="r-scripts.html#create-and-save-a-script"><i class="fa fa-check"></i><b>7.1</b> Create and save a script</a></li>
<li class="chapter" data-level="7.2" data-path="r-scripts.html"><a href="r-scripts.html#r-syntax"><i class="fa fa-check"></i><b>7.2</b> R syntax</a></li>
<li class="chapter" data-level="7.3" data-path="r-scripts.html"><a href="r-scripts.html#rstudio-tips-in-the-console"><i class="fa fa-check"></i><b>7.3</b> RStudio tips in the console</a></li>
<li class="chapter" data-level="7.4" data-path="r-scripts.html"><a href="r-scripts.html#exercice-1.-getting-started."><i class="fa fa-check"></i><b>7.4</b> Exercice 1. Getting started.</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>8</b> Data types</a></li>
<li class="chapter" data-level="9" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>9</b> Data structures</a><ul>
<li class="chapter" data-level="9.1" data-path="data-structures.html"><a href="data-structures.html#vectors"><i class="fa fa-check"></i><b>9.1</b> Vectors</a><ul>
<li class="chapter" data-level="9.1.1" data-path="data-structures.html"><a href="data-structures.html#creating-a-vector"><i class="fa fa-check"></i><b>9.1.1</b> Creating a vector</a></li>
<li class="chapter" data-level="9.1.2" data-path="data-structures.html"><a href="data-structures.html#vector-manipulation"><i class="fa fa-check"></i><b>9.1.2</b> Vector manipulation</a></li>
<li class="chapter" data-level="9.1.3" data-path="data-structures.html"><a href="data-structures.html#combining-vectors"><i class="fa fa-check"></i><b>9.1.3</b> Combining vectors</a></li>
<li class="chapter" data-level="9.1.4" data-path="data-structures.html"><a href="data-structures.html#numeric-vector-manipulation"><i class="fa fa-check"></i><b>9.1.4</b> Numeric vector manipulation</a></li>
<li class="chapter" data-level="9.1.5" data-path="data-structures.html"><a href="data-structures.html#character-vector-manipulation"><i class="fa fa-check"></i><b>9.1.5</b> Character vector manipulation</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="data-structures.html"><a href="data-structures.html#exercise-2.-numeric-vector-manipulation"><i class="fa fa-check"></i><b>9.2</b> Exercise 2. Numeric vector manipulation</a><ul>
<li class="chapter" data-level="9.2.1" data-path="data-structures.html"><a href="data-structures.html#exercise-2a."><i class="fa fa-check"></i><b>9.2.1</b> Exercise 2a.</a></li>
<li class="chapter" data-level="9.2.2" data-path="data-structures.html"><a href="data-structures.html#exercise-2b."><i class="fa fa-check"></i><b>9.2.2</b> Exercise 2b.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="data-structures.html"><a href="data-structures.html#exercise-3.-character-vector-manipulation"><i class="fa fa-check"></i><b>9.3</b> Exercise 3. Character vector manipulation</a><ul>
<li class="chapter" data-level="9.3.1" data-path="data-structures.html"><a href="data-structures.html#exercise-3a."><i class="fa fa-check"></i><b>9.3.1</b> Exercise 3a.</a></li>
<li class="chapter" data-level="9.3.2" data-path="data-structures.html"><a href="data-structures.html#exercise-3b."><i class="fa fa-check"></i><b>9.3.2</b> Exercise 3b.</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="data-structures.html"><a href="data-structures.html#factors"><i class="fa fa-check"></i><b>9.4</b> Factors</a></li>
<li class="chapter" data-level="9.5" data-path="data-structures.html"><a href="data-structures.html#matrices"><i class="fa fa-check"></i><b>9.5</b> Matrices</a><ul>
<li class="chapter" data-level="9.5.1" data-path="data-structures.html"><a href="data-structures.html#creating-a-matrix"><i class="fa fa-check"></i><b>9.5.1</b> Creating a matrix</a></li>
<li class="chapter" data-level="9.5.2" data-path="data-structures.html"><a href="data-structures.html#two-dimensional-object"><i class="fa fa-check"></i><b>9.5.2</b> Two-dimensional object</a></li>
<li class="chapter" data-level="9.5.3" data-path="data-structures.html"><a href="data-structures.html#matrix-manipulation"><i class="fa fa-check"></i><b>9.5.3</b> Matrix manipulation</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="data-structures.html"><a href="data-structures.html#data-frames"><i class="fa fa-check"></i><b>9.6</b> Data frames</a><ul>
<li class="chapter" data-level="9.6.1" data-path="data-structures.html"><a href="data-structures.html#create-a-data-frame"><i class="fa fa-check"></i><b>9.6.1</b> Create a data frame</a></li>
<li class="chapter" data-level="9.6.2" data-path="data-structures.html"><a href="data-structures.html#data-frame-manipulation"><i class="fa fa-check"></i><b>9.6.2</b> Data frame manipulation:</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="data-structures.html"><a href="data-structures.html#two-dimensional-structures-manipulation"><i class="fa fa-check"></i><b>9.7</b> Two-dimensional structures manipulation</a><ul>
<li class="chapter" data-level="9.7.1" data-path="data-structures.html"><a href="data-structures.html#dimensions"><i class="fa fa-check"></i><b>9.7.1</b> Dimensions</a></li>
<li class="chapter" data-level="9.7.2" data-path="data-structures.html"><a href="data-structures.html#manipulation"><i class="fa fa-check"></i><b>9.7.2</b> Manipulation</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="data-structures.html"><a href="data-structures.html#exercise-4.-matrix-manipulation"><i class="fa fa-check"></i><b>9.8</b> Exercise 4. Matrix manipulation</a></li>
<li class="chapter" data-level="9.9" data-path="data-structures.html"><a href="data-structures.html#exercise-5.-data-frame-manipulation"><i class="fa fa-check"></i><b>9.9</b> Exercise 5. Data frame manipulation</a><ul>
<li class="chapter" data-level="9.9.1" data-path="data-structures.html"><a href="data-structures.html#exercise-5a"><i class="fa fa-check"></i><b>9.9.1</b> Exercise 5a</a></li>
<li class="chapter" data-level="9.9.2" data-path="data-structures.html"><a href="data-structures.html#exercise-5b"><i class="fa fa-check"></i><b>9.9.2</b> Exercise 5b</a></li>
<li class="chapter" data-level="9.9.3" data-path="data-structures.html"><a href="data-structures.html#exercise-5c"><i class="fa fa-check"></i><b>9.9.3</b> Exercise 5c</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>10</b> Missing values</a></li>
<li class="chapter" data-level="11" data-path="input-output.html"><a href="input-output.html"><i class="fa fa-check"></i><b>11</b> Input / Output</a><ul>
<li class="chapter" data-level="11.1" data-path="input-output.html"><a href="input-output.html#on-vectors"><i class="fa fa-check"></i><b>11.1</b> On vectors</a></li>
<li class="chapter" data-level="11.2" data-path="input-output.html"><a href="input-output.html#on-data-frames-or-matrices"><i class="fa fa-check"></i><b>11.2</b> On data frames or matrices</a></li>
<li class="chapter" data-level="11.3" data-path="input-output.html"><a href="input-output.html#exercise-6."><i class="fa fa-check"></i><b>11.3</b> Exercise 6.</a><ul>
<li class="chapter" data-level="11.3.1" data-path="input-output.html"><a href="input-output.html#exercise-6a.-input-output"><i class="fa fa-check"></i><b>11.3.1</b> Exercise 6a. Input / output</a></li>
<li class="chapter" data-level="11.3.2" data-path="input-output.html"><a href="input-output.html#exercise-6b---io-on-data-frame-play-with-the-arguments-of-read.table"><i class="fa fa-check"></i><b>11.3.2</b> Exercise 6b - I/O on data frame: play with the arguments of read.table</a></li>
<li class="chapter" data-level="11.3.3" data-path="input-output.html"><a href="input-output.html#exercice-6c---io-on-a-data-frame"><i class="fa fa-check"></i><b>11.3.3</b> Exercice 6c - I/O on a data frame</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="library-and-packages.html"><a href="library-and-packages.html"><i class="fa fa-check"></i><b>12</b> Library and packages</a><ul>
<li class="chapter" data-level="12.1" data-path="library-and-packages.html"><a href="library-and-packages.html#r-base"><i class="fa fa-check"></i><b>12.1</b> R base</a></li>
<li class="chapter" data-level="12.2" data-path="library-and-packages.html"><a href="library-and-packages.html#r-contrib"><i class="fa fa-check"></i><b>12.2</b> R contrib</a></li>
<li class="chapter" data-level="12.3" data-path="library-and-packages.html"><a href="library-and-packages.html#install-a-package"><i class="fa fa-check"></i><b>12.3</b> Install a package</a></li>
<li class="chapter" data-level="12.4" data-path="library-and-packages.html"><a href="library-and-packages.html#load-a-package"><i class="fa fa-check"></i><b>12.4</b> Load a package</a></li>
<li class="chapter" data-level="12.5" data-path="library-and-packages.html"><a href="library-and-packages.html#check-what-packages-are-currently-loaded"><i class="fa fa-check"></i><b>12.5</b> Check what packages are currently loaded</a></li>
<li class="chapter" data-level="12.6" data-path="library-and-packages.html"><a href="library-and-packages.html#list-functions-from-a-package"><i class="fa fa-check"></i><b>12.6</b> List functions from a package</a></li>
<li class="chapter" data-level="12.7" data-path="library-and-packages.html"><a href="library-and-packages.html#rstudio-server-at-crg"><i class="fa fa-check"></i><b>12.7</b> RStudio server at CRG</a></li>
<li class="chapter" data-level="12.8" data-path="library-and-packages.html"><a href="library-and-packages.html#exercise-7-library-and-packages"><i class="fa fa-check"></i><b>12.8</b> Exercise 7: Library and packages</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="regular-expressions.html"><a href="regular-expressions.html"><i class="fa fa-check"></i><b>13</b> Regular expressions</a><ul>
<li class="chapter" data-level="13.1" data-path="regular-expressions.html"><a href="regular-expressions.html#find-simple-matches-with-grep"><i class="fa fa-check"></i><b>13.1</b> Find simple matches with grep</a></li>
<li class="chapter" data-level="13.2" data-path="regular-expressions.html"><a href="regular-expressions.html#regular-expressions-to-find-more-flexible-patterns"><i class="fa fa-check"></i><b>13.2</b> Regular expressions to find more flexible patterns</a></li>
<li class="chapter" data-level="13.3" data-path="regular-expressions.html"><a href="regular-expressions.html#substitute-or-remove-matching-patterns-with-gsub"><i class="fa fa-check"></i><b>13.3</b> Substitute or remove matching patterns with gsub</a></li>
<li class="chapter" data-level="13.4" data-path="regular-expressions.html"><a href="regular-expressions.html#predefined-variables-to-use-in-regular-expressions"><i class="fa fa-check"></i><b>13.4</b> Predefined variables to use in regular expressions:</a></li>
<li class="chapter" data-level="13.5" data-path="regular-expressions.html"><a href="regular-expressions.html#use-grep-and-regular-expressions-to-retrieve-columns-by-their-names"><i class="fa fa-check"></i><b>13.5</b> Use grep and regular expressions to retrieve columns by their names</a></li>
<li class="chapter" data-level="13.6" data-path="regular-expressions.html"><a href="regular-expressions.html#exercise-8-regular-expressions"><i class="fa fa-check"></i><b>13.6</b> Exercise 8: Regular expressions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="repetitive-execution.html"><a href="repetitive-execution.html"><i class="fa fa-check"></i><b>14</b> Repetitive execution</a><ul>
<li class="chapter" data-level="14.1" data-path="repetitive-execution.html"><a href="repetitive-execution.html#exercise-9-for-loop"><i class="fa fa-check"></i><b>14.1</b> Exercise 9: For loop</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="conditional-statement.html"><a href="conditional-statement.html"><i class="fa fa-check"></i><b>15</b> Conditional statement</a><ul>
<li class="chapter" data-level="15.1" data-path="conditional-statement.html"><a href="conditional-statement.html#exercise-10-if-statement"><i class="fa fa-check"></i><b>15.1</b> Exercise 10: If statement</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="basic-plots-in-r.html"><a href="basic-plots-in-r.html"><i class="fa fa-check"></i><b>16</b> Basic plots in R</a><ul>
<li class="chapter" data-level="16.1" data-path="basic-plots-in-r.html"><a href="basic-plots-in-r.html#scatter-plots"><i class="fa fa-check"></i><b>16.1</b> Scatter plots</a></li>
<li class="chapter" data-level="16.2" data-path="basic-plots-in-r.html"><a href="basic-plots-in-r.html#bar-plots"><i class="fa fa-check"></i><b>16.2</b> Bar plots</a></li>
<li class="chapter" data-level="16.3" data-path="basic-plots-in-r.html"><a href="basic-plots-in-r.html#pie-charts"><i class="fa fa-check"></i><b>16.3</b> Pie charts</a></li>
<li class="chapter" data-level="16.4" data-path="basic-plots-in-r.html"><a href="basic-plots-in-r.html#box-plots"><i class="fa fa-check"></i><b>16.4</b> Box plots</a></li>
<li class="chapter" data-level="16.5" data-path="basic-plots-in-r.html"><a href="basic-plots-in-r.html#histograms"><i class="fa fa-check"></i><b>16.5</b> Histograms</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html"><i class="fa fa-check"></i><b>17</b> How to save plots</a><ul>
<li class="chapter" data-level="17.1" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#with-r-studio"><i class="fa fa-check"></i><b>17.1</b> With R Studio</a></li>
<li class="chapter" data-level="17.2" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#with-the-console"><i class="fa fa-check"></i><b>17.2</b> With the console</a></li>
<li class="chapter" data-level="17.3" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#exercise-11-base-plots"><i class="fa fa-check"></i><b>17.3</b> Exercise 11: Base plots</a><ul>
<li class="chapter" data-level="17.3.1" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#exercise-11a--scatter-plot"><i class="fa fa-check"></i><b>17.3.1</b> Exercise 11a- scatter plot</a></li>
<li class="chapter" data-level="17.3.2" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#exercise-11b--bar-plot-pie-chart"><i class="fa fa-check"></i><b>17.3.2</b> Exercise 11b- bar plot + pie chart</a></li>
<li class="chapter" data-level="17.3.3" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#exercise-11c--histogram"><i class="fa fa-check"></i><b>17.3.3</b> Exercise 11c- histogram</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="plots-from-other-packages.html"><a href="plots-from-other-packages.html"><i class="fa fa-check"></i><b>18</b> Plots from other packages</a><ul>
<li class="chapter" data-level="18.1" data-path="plots-from-other-packages.html"><a href="plots-from-other-packages.html#heatmap.2-function-from-gplots-package"><i class="fa fa-check"></i><b>18.1</b> heatmap.2 function from gplots package</a></li>
<li class="chapter" data-level="18.2" data-path="plots-from-other-packages.html"><a href="plots-from-other-packages.html#venn.diagram-function-from-venndiagram-package"><i class="fa fa-check"></i><b>18.2</b> venn.diagram function from VennDiagram package</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="ggplot2-package.html"><a href="ggplot2-package.html"><i class="fa fa-check"></i><b>19</b> ggplot2 package</a><ul>
<li class="chapter" data-level="19.1" data-path="ggplot2-package.html"><a href="ggplot2-package.html#getting-started"><i class="fa fa-check"></i><b>19.1</b> Getting started</a></li>
<li class="chapter" data-level="19.2" data-path="ggplot2-package.html"><a href="ggplot2-package.html#scatter-plot"><i class="fa fa-check"></i><b>19.2</b> Scatter plot</a></li>
<li class="chapter" data-level="19.3" data-path="ggplot2-package.html"><a href="ggplot2-package.html#box-plots-1"><i class="fa fa-check"></i><b>19.3</b> Box plots</a></li>
<li class="chapter" data-level="19.4" data-path="ggplot2-package.html"><a href="ggplot2-package.html#dot-plots"><i class="fa fa-check"></i><b>19.4</b> Dot plots</a></li>
<li class="chapter" data-level="19.5" data-path="ggplot2-package.html"><a href="ggplot2-package.html#bar-plots-1"><i class="fa fa-check"></i><b>19.5</b> Bar plots</a></li>
<li class="chapter" data-level="19.6" data-path="ggplot2-package.html"><a href="ggplot2-package.html#histograms-1"><i class="fa fa-check"></i><b>19.6</b> Histograms</a></li>
<li class="chapter" data-level="19.7" data-path="ggplot2-package.html"><a href="ggplot2-package.html#about-themes"><i class="fa fa-check"></i><b>19.7</b> About themes</a></li>
<li class="chapter" data-level="19.8" data-path="ggplot2-package.html"><a href="ggplot2-package.html#saving-plots-in-files"><i class="fa fa-check"></i><b>19.8</b> Saving plots in files</a></li>
<li class="chapter" data-level="19.9" data-path="ggplot2-package.html"><a href="ggplot2-package.html#exercise-12-ggplot2"><i class="fa fa-check"></i><b>19.9</b> Exercise 12: ggplot2</a><ul>
<li class="chapter" data-level="19.9.1" data-path="ggplot2-package.html"><a href="ggplot2-package.html#exercise-12a--scatter-plot"><i class="fa fa-check"></i><b>19.9.1</b> Exercise 12a- Scatter plot</a></li>
<li class="chapter" data-level="19.9.2" data-path="ggplot2-package.html"><a href="ggplot2-package.html#exercise-12b--box-plot"><i class="fa fa-check"></i><b>19.9.2</b> Exercise 12b- Box plot</a></li>
<li class="chapter" data-level="19.9.3" data-path="ggplot2-package.html"><a href="ggplot2-package.html#exercise-12c--bar-plot"><i class="fa fa-check"></i><b>19.9.3</b> Exercise 12c- Bar plot</a></li>
<li class="chapter" data-level="19.9.4" data-path="ggplot2-package.html"><a href="ggplot2-package.html#exercise-12d--histogram"><i class="fa fa-check"></i><b>19.9.4</b> Exercise 12d- Histogram</a></li>
</ul></li>
<li class="chapter" data-level="19.10" data-path="ggplot2-package.html"><a href="ggplot2-package.html#more-about-the-theme-function"><i class="fa fa-check"></i><b>19.10</b> More about the theme() function</a></li>
<li class="chapter" data-level="19.11" data-path="ggplot2-package.html"><a href="ggplot2-package.html#volcano-plots"><i class="fa fa-check"></i><b>19.11</b> Volcano plots</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-structures" class="section level1">
<h1><span class="header-section-number">Part9</span> Data structures</h1>
<p>The main data structures are:</p>
<ul>
<li>Vector</li>
<li>Factor</li>
<li>Matrix</li>
<li>Data frame</li>
</ul>

<div id="vectors" class="section level2">
<h2><span class="header-section-number">9.1</span> Vectors</h2>
<p>A vector is a sequence of data elements from the <strong>same type</strong>.</p>
<div class="line-block">329 | 45 | 12 | 28 |</div>
<div id="creating-a-vector" class="section level3">
<h3><span class="header-section-number">9.1.1</span> Creating a vector</h3>
<ul>
<li>Values are assigned to a vector using the <strong>c</strong> command (<strong>c</strong>ombining elements).</li>
</ul>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">329</span>, <span class="dv">45</span>, <span class="dv">12</span>, <span class="dv">28</span>)</a></code></pre></div>
<p>You can create an empty vector with:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">vecempty &lt;-<span class="st"> </span><span class="kw">vector</span>()</a></code></pre></div>
<ul>
<li>Create a sequence of consecutive numbers:</li>
</ul>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">6</span></a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="co"># same as:</span></a>
<a class="sourceLine" id="cb55-3" data-line-number="3">a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb55-4" data-line-number="4"><span class="co"># both ends (1 and 6) are included</span></a></code></pre></div>
<ul>
<li>Character vectors: Each element is entered between (single or double) quotes.</li>
</ul>
<div class="line-block">mRNA | miRNA | snoRNA | lncRNA |</div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1">b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;mRNA&quot;</span>, <span class="st">&quot;miRNA&quot;</span>, <span class="st">&quot;snoRNA&quot;</span>, <span class="st">&quot;lncRNA&quot;</span>)</a></code></pre></div>
</div>
<div id="vector-manipulation" class="section level3">
<h3><span class="header-section-number">9.1.2</span> Vector manipulation</h3>
<ul>
<li>A vector can be <strong>named</strong>: each element of the vector can be assigned a name (number or character)</li>
</ul>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="kw">names</span>(a) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;mRNA&quot;</span>, <span class="st">&quot;miRNA&quot;</span>, <span class="st">&quot;snoRNA&quot;</span>, <span class="st">&quot;lncRNA&quot;</span>)</a>
<a class="sourceLine" id="cb57-2" data-line-number="2"><span class="co"># use an object which already contains a vector</span></a>
<a class="sourceLine" id="cb57-3" data-line-number="3"><span class="kw">names</span>(a) &lt;-<span class="st"> </span>b</a></code></pre></div>
<ul>
<li>Get the length (number of elements) of a vector</li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="kw">length</span>(a)</a></code></pre></div>
<pre><code>## [1] 6</code></pre>
<ul>
<li>Extracting elements from vector <strong>a</strong>
<ul>
<li>extract elements using their position (index) in the vector:
<img src="images/vector_indices.png" width="500"></li>
</ul>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">6</span></a>
<a class="sourceLine" id="cb60-2" data-line-number="2">a[<span class="dv">1</span>]</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">a[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</a></code></pre></div>
<pre><code>## [1] 1 3</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">a[<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>]</a></code></pre></div>
<pre><code>## [1] 2 3 4</code></pre>
<ul>
<li>extract elements using their names:
<img src="images/vector_indices_names.png" width="500"></li>
</ul>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">a[<span class="st">&quot;mRNA&quot;</span>]</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1">a[<span class="kw">c</span>(<span class="st">&quot;miRNA&quot;</span>, <span class="st">&quot;lncRNA&quot;</span>)]            </a></code></pre></div>
<pre><code>## [1] NA NA</code></pre></li>
<li>Reassigning a vector’s element</li>
</ul>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1">a[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">31</span></a>
<a class="sourceLine" id="cb70-2" data-line-number="2">a[<span class="st">&quot;miRNA&quot;</span>] &lt;-<span class="st"> </span><span class="dv">31</span></a></code></pre></div>
<ul>
<li>Removing a vector’s element</li>
</ul>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1">a &lt;-<span class="st"> </span>a[<span class="op">-</span><span class="dv">3</span>]</a></code></pre></div>
<ul>
<li><strong>Show</strong> versus <strong>change</strong></li>
</ul>
<p>x[-2] <img src="images/red_triangle.jpg" width="40"> x <span style="color:red">unchanged</span> !</p>
<p>x &lt;- x[-2] <img src="images/red_triangle.jpg" width="40"> x <span style="color:red">reassigned</span> !</p>
</div>
<div id="combining-vectors" class="section level3">
<h3><span class="header-section-number">9.1.3</span> Combining vectors</h3>
<ul>
<li>From 2 vectors <strong>a</strong> and <strong>b</strong> you can create a vector <strong>d</strong></li>
</ul>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb72-2" data-line-number="2">b &lt;-<span class="st"> </span><span class="dv">4</span><span class="op">:</span><span class="dv">6</span></a>
<a class="sourceLine" id="cb72-3" data-line-number="3">d &lt;-<span class="st"> </span><span class="kw">c</span>(a, b)</a></code></pre></div>
<blockquote>
<p>The elements of <strong>b</strong> are added after the elements of <strong>a</strong></p>
</blockquote>
<ul>
<li>Likewise, you can add elements at the end of a vector</li>
</ul>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1">d &lt;-<span class="st"> </span><span class="kw">c</span>(d, <span class="dv">19</span>)</a></code></pre></div>
</div>
<div id="numeric-vector-manipulation" class="section level3">
<h3><span class="header-section-number">9.1.4</span> Numeric vector manipulation</h3>
<h4>
Logical operators
</h4>
<table>
<thead>
<tr class="header">
<th align="center">Operator</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">&lt;</td>
<td align="center">less than</td>
</tr>
<tr class="even">
<td align="center">&lt;=</td>
<td align="center">less than or equal to</td>
</tr>
<tr class="odd">
<td align="center">&gt;</td>
<td align="center">greater than</td>
</tr>
<tr class="even">
<td align="center">&gt;=</td>
<td align="center">greater than or equal to</td>
</tr>
<tr class="odd">
<td align="center">==</td>
<td align="center">exactly equal to</td>
</tr>
<tr class="even">
<td align="center">!=</td>
<td align="center">not equal to</td>
</tr>
<tr class="odd">
<td align="center">!x</td>
<td align="center">not x</td>
</tr>
<tr class="even">
<td align="center">x | y</td>
<td align="center">x OR y</td>
</tr>
<tr class="odd">
<td align="center">x &amp; y</td>
<td align="center">x AND y</td>
</tr>
</tbody>
</table>
<ul>
<li>Which elements of <strong>a</strong> are equal to 2?</li>
</ul>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb74-2" data-line-number="2">a <span class="op">==</span><span class="st"> </span><span class="dv">2</span></a></code></pre></div>
<pre><code>## [1] FALSE  TRUE FALSE FALSE FALSE</code></pre>
<p><img src="images/vector_equal.png" width="450"></p>
<ul>
<li>Which elements of <strong>a</strong> are superior to 2?</li>
</ul>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb76-2" data-line-number="2">a <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span></a></code></pre></div>
<pre><code>## [1] FALSE FALSE  TRUE  TRUE  TRUE</code></pre>
<p><img src="images/vector_super.png" width="450"></p>
<ul>
<li>Extract elements of a vector that comply with a condition:</li>
</ul>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb78-2" data-line-number="2">a <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span></a></code></pre></div>
<pre><code>## [1] FALSE  TRUE  TRUE  TRUE  TRUE</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1">a[a <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span>]</a></code></pre></div>
<pre><code>## [1] 2 3 4 5</code></pre>
<p><img src="images/vector_subvector.png" width="500"></p>
<div id="operations-on-vectors" class="section level4">
<h4><span class="header-section-number">9.1.4.1</span> Operations on vectors</h4>
<ul>
<li>Adding 2 to a vector adds 2 to <strong>each element</strong> of the vector:</li>
</ul>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb82-2" data-line-number="2">a <span class="op">+</span><span class="st"> </span><span class="dv">2</span></a></code></pre></div>
<pre><code>## [1] 3 4 5 6 7</code></pre>
<p><img src="images/vector_addition.png" width="350"></p>
<blockquote>
<p>Same goes for subtractions, multiplications and divisions…</p>
</blockquote>
<ul>
<li>Multiplying a vector by another vector of equal length</li>
</ul>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb84-2" data-line-number="2">b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb84-3" data-line-number="3">a <span class="op">*</span><span class="st"> </span>b</a></code></pre></div>
<pre><code>## [1]  4 12  0</code></pre>
<p><img src="images/vector_multiply.png" width="220"></p>
<ul>
<li>Multiplying a vector by another <strong>shorter</strong> vector</li>
</ul>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb86-2" data-line-number="2">b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb86-3" data-line-number="3">a <span class="op">*</span><span class="st"> </span>b</a></code></pre></div>
<pre><code>## Warning in a * b: longer object length is not a multiple of shorter object
## length</code></pre>
<pre><code>## [1]  4 12  0  6  3</code></pre>
<p><img src="images/vector_multi_recycle.png" width="300"></p>
<blockquote>
<p>Vector <strong>a</strong> is “recycled” !</p>
</blockquote>
<ul>
<li>Summary statistics</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="center">Function</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">mean(x)</td>
<td align="center">mean / average</td>
</tr>
<tr class="even">
<td align="center">median(x)</td>
<td align="center">median</td>
</tr>
<tr class="odd">
<td align="center">min(x)</td>
<td align="center">minimum</td>
</tr>
<tr class="even">
<td align="center">max(x)</td>
<td align="center">maximum</td>
</tr>
<tr class="odd">
<td align="center">var(x)</td>
<td align="center">variance</td>
</tr>
<tr class="even">
<td align="center">summary(x)</td>
<td align="center">mean, median, min, max, quartiles</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">12</span>, <span class="dv">45</span>, <span class="dv">3</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb89-2" data-line-number="2"><span class="kw">summary</span>(a)</a></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1.00    2.25    3.00   11.00    9.75   45.00</code></pre>
</div>
<div id="comparing-vectors" class="section level4">
<h4><span class="header-section-number">9.1.4.2</span> Comparing vectors</h4>
<ul>
<li>The <strong>%in%</strong> operator</li>
</ul>
<p>Which elements of <strong>a</strong> are also found in **b* ?</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">6</span></a>
<a class="sourceLine" id="cb91-2" data-line-number="2">b &lt;-<span class="st"> </span><span class="dv">4</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb91-3" data-line-number="3">a <span class="op">%in%</span><span class="st"> </span>b</a></code></pre></div>
<pre><code>## [1] FALSE FALSE  TRUE  TRUE  TRUE</code></pre>
<p><img src="images/vector_in.png" width="350"></p>
<p>Retrieve actual elements of <strong>a</strong> that are found in <strong>b</strong>:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">6</span></a>
<a class="sourceLine" id="cb93-2" data-line-number="2">b &lt;-<span class="st"> </span><span class="dv">4</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb93-3" data-line-number="3">a[a <span class="op">%in%</span><span class="st"> </span>b]</a></code></pre></div>
<pre><code>## [1] 4 5 6</code></pre>
</div>
</div>
<div id="character-vector-manipulation" class="section level3">
<h3><span class="header-section-number">9.1.5</span> Character vector manipulation</h3>
<p>Character vectors are manipulated similarly to numeric ones.</p>
<ul>
<li>The <strong>%in%</strong> operator:</li>
</ul>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1">k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;mRNA&quot;</span>, <span class="st">&quot;miRNA&quot;</span>, <span class="st">&quot;snoRNA&quot;</span>, <span class="st">&quot;RNA&quot;</span>, <span class="st">&quot;lincRNA&quot;</span>)</a>
<a class="sourceLine" id="cb95-2" data-line-number="2">p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;mRNA&quot;</span>,<span class="st">&quot;lincRNA&quot;</span>, <span class="st">&quot;tRNA&quot;</span>, <span class="st">&quot;miRNA&quot;</span>)</a>
<a class="sourceLine" id="cb95-3" data-line-number="3">k <span class="op">%in%</span><span class="st"> </span>p</a></code></pre></div>
<pre><code>## [1]  TRUE  TRUE FALSE FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1">k[k <span class="op">%in%</span><span class="st"> </span>p]</a></code></pre></div>
<pre><code>## [1] &quot;mRNA&quot;    &quot;miRNA&quot;   &quot;lincRNA&quot;</code></pre>
<ul>
<li>Select elements from vector <strong>m</strong> that are not <em>exon</em></li>
</ul>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1">m &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;exon&quot;</span>, <span class="st">&quot;intron&quot;</span>, <span class="st">&quot;exon&quot;</span>)</a>
<a class="sourceLine" id="cb99-2" data-line-number="2">m <span class="op">!=</span><span class="st"> &quot;exon&quot;</span></a></code></pre></div>
<pre><code>## [1] FALSE  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1">m[m <span class="op">!=</span><span class="st"> &quot;exon&quot;</span>]</a></code></pre></div>
<pre><code>## [1] &quot;intron&quot;</code></pre>

</div>
</div>
<div id="exercise-2.-numeric-vector-manipulation" class="section level2">
<h2><span class="header-section-number">9.2</span> Exercise 2. Numeric vector manipulation</h2>
<div id="exercise-2a." class="section level3">
<h3><span class="header-section-number">9.2.1</span> Exercise 2a.</h3>
<p>Create the script “exercise2.R” and save it to the “Rcourse/Module1” directory: you will save all the commands of exercise 2 in that script.
<br>Remember you can comment the code using #.</p>
<p><strong>1- Go to Rcourse/Module1
First check where you currently are with getwd();
then go to Rcourse/Module1 with setwd()</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" data-line-number="1"><span class="kw">getwd</span>()</a>
<a class="sourceLine" id="cb103-2" data-line-number="2"><span class="kw">setwd</span>(<span class="st">&quot;Rcourse/Module1&quot;</span>)</a>
<a class="sourceLine" id="cb103-3" data-line-number="3"><span class="kw">setwd</span>(<span class="st">&quot;~/Rcourse/Module1&quot;</span>)</a></code></pre></div>
</details>
<p><strong>2- Create a numeric vector y which contains the numbers from 2 to 11, both included.</strong>
<br>Show y in the terminal.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>)</a>
<a class="sourceLine" id="cb104-2" data-line-number="2"><span class="co"># same as</span></a>
<a class="sourceLine" id="cb104-3" data-line-number="3">y &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">11</span></a>
<a class="sourceLine" id="cb104-4" data-line-number="4"><span class="co"># show in terminal:</span></a>
<a class="sourceLine" id="cb104-5" data-line-number="5">y</a></code></pre></div>
<pre><code>##  [1]  2  3  4  5  6  7  8  9 10 11</code></pre>
</details>
<p><strong>3- How many elements are in y? I.e what is the length of vector y ?</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1"><span class="kw">length</span>(y)</a></code></pre></div>
<pre><code>## [1] 10</code></pre>
</details>
<p><strong>4- Show the 2nd element of y.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1">y[<span class="dv">2</span>]</a></code></pre></div>
<pre><code>## [1] 3</code></pre>
</details>
<p><strong>5- Show the 3rd and the 6th elements of y.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1">y[<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>## [1] 4 7</code></pre>
</details>
<p><strong>6- Remove the 4th element of y: reassign. What is now the length of y ?</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1"><span class="co"># remove 4th element and reassign</span></a>
<a class="sourceLine" id="cb112-2" data-line-number="2">y &lt;-<span class="st"> </span>y[<span class="op">-</span><span class="dv">4</span>]</a>
<a class="sourceLine" id="cb112-3" data-line-number="3"><span class="co"># length of y</span></a>
<a class="sourceLine" id="cb112-4" data-line-number="4"><span class="kw">length</span>(y)</a></code></pre></div>
<pre><code>## [1] 9</code></pre>
</details>
<p><strong>7- Show all elements of y that are less than 7.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" data-line-number="1"><span class="co"># which elements of y are less than 7:</span></a>
<a class="sourceLine" id="cb114-2" data-line-number="2">y <span class="op">&lt;</span><span class="st"> </span><span class="dv">7</span></a></code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" data-line-number="1"><span class="co"># show those elements </span></a>
<a class="sourceLine" id="cb116-2" data-line-number="2">y[ y <span class="op">&lt;</span><span class="st"> </span><span class="dv">7</span> ]</a></code></pre></div>
<pre><code>## [1] 2 3 4 6</code></pre>
</details>
<p><strong>8- Show all elements of y that are greater or equal to 4 and less than 9.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" data-line-number="1">y[ y <span class="op">&gt;=</span><span class="st"> </span><span class="dv">4</span> <span class="op">&amp;</span><span class="st"> </span>y <span class="op">&lt;</span><span class="st"> </span><span class="dv">9</span> ]</a></code></pre></div>
<pre><code>## [1] 4 6 7 8</code></pre>
</details>
<p><strong>9- Create the vector x of 1000 random numbers from the normal distribution:</strong>
<br><strong><em>First read the help page of the rnorm() function.</em></strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1"><span class="co"># help page for the rnorm function</span></a>
<a class="sourceLine" id="cb120-2" data-line-number="2"><span class="kw">help</span>(rnorm)</a>
<a class="sourceLine" id="cb120-3" data-line-number="3"><span class="co"># produce a vector of 1000 random numbers from the normal distribution</span></a>
<a class="sourceLine" id="cb120-4" data-line-number="4">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>)</a></code></pre></div>
</details>
<p><strong>10. What are the mean, median, minimum and maximum values of x?</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" data-line-number="1"><span class="kw">mean</span>(x); <span class="kw">median</span>(x); <span class="kw">min</span>(x); <span class="kw">max</span>(x)</a></code></pre></div>
<pre><code>## [1] -6.068539e-05</code></pre>
<pre><code>## [1] 0.003553454</code></pre>
<pre><code>## [1] -2.97772</code></pre>
<pre><code>## [1] 3.05416</code></pre>
</details>
<p><strong>11- Run the summary() function on x. <br>What additional information do you obtain ?</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" data-line-number="1"><span class="kw">summary</span>(x)</a></code></pre></div>
<pre><code>##       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
## -2.9777195 -0.6498501  0.0035535 -0.0000607  0.6728973  3.0541595</code></pre>
</details>
<p><strong>12- Create vector y2 as:</strong><br></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" data-line-number="1">y2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">11</span>, <span class="dv">5</span>, <span class="dv">62</span>,  <span class="dv">18</span>, <span class="dv">2</span>, <span class="dv">8</span>)</a></code></pre></div>
<p><strong>13. What is the sum of all elements in y2 ?</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" data-line-number="1"><span class="kw">sum</span>(y2)</a></code></pre></div>
<pre><code>## [1] 107</code></pre>
</details>
<p><strong>14- Which elements of y2 are also present in y ?
<br>Note: remember the %in% operator.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" data-line-number="1">y2[ y2 <span class="op">%in%</span><span class="st"> </span>y ]</a></code></pre></div>
<pre><code>## [1] 11  2  8</code></pre>
</details>
<p><strong>15- Multiply each element of y2 by 1.5: reassign.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" data-line-number="1">y2 &lt;-<span class="st"> </span>y2 <span class="op">*</span><span class="st"> </span><span class="fl">1.5</span></a></code></pre></div>
</details>
<p><strong>16- Use the function any() to check if the number 3 is present.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" data-line-number="1"><span class="co"># &quot;Given a set of logical vectors, is at least one of the values true?&quot;</span></a>
<a class="sourceLine" id="cb134-2" data-line-number="2"><span class="kw">any</span>( y2 <span class="op">==</span><span class="st"> </span><span class="dv">3</span> )</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</details>
</div>
<div id="exercise-2b." class="section level3">
<h3><span class="header-section-number">9.2.2</span> Exercise 2b.</h3>
<p><strong>1- Create the vector myvector as:</strong></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" data-line-number="1">myvector &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</a></code></pre></div>
<p><strong>Create the same vector using the rep() function (?rep)</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" data-line-number="1">myvector &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">3</span>)</a></code></pre></div>
</details>
<p><strong>2- Reassign the 5th, 6th and 7th position of myvector with the values 8, 12 and 32, respectively.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" data-line-number="1"><span class="co"># reassign one by one</span></a>
<a class="sourceLine" id="cb138-2" data-line-number="2">myvector[<span class="dv">5</span>] &lt;-<span class="st"> </span><span class="dv">8</span></a>
<a class="sourceLine" id="cb138-3" data-line-number="3">myvector[<span class="dv">6</span>] &lt;-<span class="st"> </span><span class="dv">12</span></a>
<a class="sourceLine" id="cb138-4" data-line-number="4">myvector[<span class="dv">7</span>] &lt;-<span class="st"> </span><span class="dv">32</span></a>
<a class="sourceLine" id="cb138-5" data-line-number="5"><span class="co"># or reassign all at once</span></a>
<a class="sourceLine" id="cb138-6" data-line-number="6">myvector[<span class="dv">5</span><span class="op">:</span><span class="dv">7</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">32</span>)</a></code></pre></div>
</details>
<p><strong>3- Calculate the fraction/percentage of each element of myvector (relative to the sum of all elements of the vector).
<br>sum() can be useful.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" data-line-number="1"><span class="co"># sum of all elements of the vector</span></a>
<a class="sourceLine" id="cb139-2" data-line-number="2">mytotal &lt;-<span class="st"> </span><span class="kw">sum</span>(myvector)</a>
<a class="sourceLine" id="cb139-3" data-line-number="3"><span class="co"># divide each element by the sum</span></a>
<a class="sourceLine" id="cb139-4" data-line-number="4">myvector <span class="op">/</span><span class="st"> </span>mytotal</a></code></pre></div>
<pre><code>## [1] 0.015625 0.031250 0.046875 0.015625 0.125000 0.187500 0.500000 0.031250
## [9] 0.046875</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" data-line-number="1"><span class="co"># multiply by 100 to get a percentage</span></a>
<a class="sourceLine" id="cb141-2" data-line-number="2">(myvector <span class="op">/</span><span class="st"> </span>mytotal) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a></code></pre></div>
<pre><code>## [1]  1.5625  3.1250  4.6875  1.5625 12.5000 18.7500 50.0000  3.1250  4.6875</code></pre>
</details>
<p><strong>4- Add vector c(2, 4, 6, 7) to myvector (combining both vectors): reassign!</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" data-line-number="1"><span class="co"># create the new vector</span></a>
<a class="sourceLine" id="cb143-2" data-line-number="2">newvector &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">7</span>)</a>
<a class="sourceLine" id="cb143-3" data-line-number="3"><span class="co"># combine both myvector and newvector</span></a>
<a class="sourceLine" id="cb143-4" data-line-number="4"><span class="kw">c</span>(myvector, newvector)</a></code></pre></div>
<pre><code>##  [1]  1  2  3  1  8 12 32  2  3  2  4  6  7</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" data-line-number="1"><span class="co"># reassign myvector</span></a>
<a class="sourceLine" id="cb145-2" data-line-number="2">myvector &lt;-<span class="st"> </span><span class="kw">c</span>(myvector, newvector)</a></code></pre></div>
</details>

</div>
</div>
<div id="exercise-3.-character-vector-manipulation" class="section level2">
<h2><span class="header-section-number">9.3</span> Exercise 3. Character vector manipulation</h2>
<div id="exercise-3a." class="section level3">
<h3><span class="header-section-number">9.3.1</span> Exercise 3a.</h3>
<p>Create the script “exercise3.R” and save it to the “Rcourse/Module1” directory: you will save all the commands of exercise 3 in that script.
<br>Remember you can comment the code using #.</p>
<p><strong>1- Go to Rcourse/Module1
First check where you currently are with getwd();
then go to Rcourse/Module1 with setwd()</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" data-line-number="1"><span class="kw">getwd</span>()</a>
<a class="sourceLine" id="cb146-2" data-line-number="2"><span class="kw">setwd</span>(<span class="st">&quot;Rcourse/Module1&quot;</span>)</a>
<a class="sourceLine" id="cb146-3" data-line-number="3"><span class="kw">setwd</span>(<span class="st">&quot;~/Rcourse/Module1&quot;</span>)</a></code></pre></div>
</details>
<p><strong>2- Create vector w as:</strong></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" data-line-number="1">w &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="st">&quot;miRNA&quot;</span>, <span class="st">&quot;mRNA&quot;</span>), <span class="dt">times=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>))</a></code></pre></div>
<p><strong>3- View vector w in the console: how does function rep() work ?</strong>
<br>Play with the <strong>times</strong> argument.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1"><span class="kw">rep</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="st">&quot;miRNA&quot;</span>, <span class="st">&quot;mRNA&quot;</span>), <span class="dt">times=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>))</a></code></pre></div>
<pre><code>## [1] &quot;miRNA&quot; &quot;miRNA&quot; &quot;miRNA&quot; &quot;mRNA&quot;  &quot;mRNA&quot;  &quot;mRNA&quot;  &quot;mRNA&quot;</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" data-line-number="1"><span class="kw">rep</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="st">&quot;miRNA&quot;</span>, <span class="st">&quot;mRNA&quot;</span>), <span class="dt">times=</span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">2</span>))</a></code></pre></div>
<pre><code>##  [1] &quot;miRNA&quot; &quot;miRNA&quot; &quot;miRNA&quot; &quot;miRNA&quot; &quot;miRNA&quot; &quot;miRNA&quot; &quot;miRNA&quot; &quot;miRNA&quot;
##  [9] &quot;miRNA&quot; &quot;miRNA&quot; &quot;mRNA&quot;  &quot;mRNA&quot;</code></pre>
</details>
<p><strong>4- What is the output of table(w) ? What does the table function do ?</strong></p>
<p><strong>5- Type w[grep(pattern=“mRNA”, x=w)] and w[w == “mRNA”]</strong>
<br> Is there a difference between the two outputs?</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" data-line-number="1">w[<span class="kw">grep</span>(<span class="dt">pattern=</span><span class="st">&quot;mRNA&quot;</span>, w)]</a></code></pre></div>
<pre><code>## [1] &quot;mRNA&quot; &quot;mRNA&quot;</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" data-line-number="1">w[w <span class="op">==</span><span class="st"> &quot;mRNA&quot;</span>]</a></code></pre></div>
<pre><code>## [1] &quot;mRNA&quot; &quot;mRNA&quot;</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" data-line-number="1"><span class="co"># no difference between the outputs</span></a></code></pre></div>
</details>
<p><strong>6- Now type w[grep(pattern=“RNA”, w)] and w[w == “RNA”]</strong>
<br> Is there a difference between the two outputs?</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" data-line-number="1">w[<span class="kw">grep</span>(<span class="dt">pattern=</span><span class="st">&quot;RNA&quot;</span>, w)]</a></code></pre></div>
<pre><code>## [1] &quot;miRNA&quot; &quot;miRNA&quot; &quot;miRNA&quot; &quot;mRNA&quot;  &quot;mRNA&quot;</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" data-line-number="1">w[w <span class="op">==</span><span class="st"> &quot;RNA&quot;</span>]</a></code></pre></div>
<pre><code>## character(0)</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" data-line-number="1"><span class="co"># grep outputs 5 values but == outputs none</span></a></code></pre></div>
</details>
<p>What is the difference between <strong>==</strong> and <strong>grep</strong> ?</p>
<details>
<p><summary>
correction
</summary></p>
<blockquote>
<p>= looks for exact matches.
<br>
grep looks for <strong>patterns</strong>.</p>
</blockquote>
</details>
<p><strong>7- Create vector g as:</strong></p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" data-line-number="1">g &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;hsa-let-7a&quot;</span>, <span class="st">&quot;hsa-mir-1&quot;</span>, <span class="st">&quot;CLC&quot;</span>, <span class="st">&quot;DKK1&quot;</span>, <span class="st">&quot;LPA&quot;</span>)</a></code></pre></div>
<p>How many elements do w and g contain?</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" data-line-number="1"><span class="kw">length</span>(w); <span class="kw">length</span>(g)</a></code></pre></div>
<pre><code>## [1] 5</code></pre>
<pre><code>## [1] 5</code></pre>
</details>
<p><strong>8- Do vectors w and g have the same length? Use the function identical() to check this.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" data-line-number="1"><span class="kw">identical</span>(<span class="dt">x=</span><span class="kw">length</span>(w), <span class="dt">y=</span><span class="kw">length</span>(g))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</details>
<p><strong>9- Name the elements of g using the elements of w.</strong><br>
(i.e. the names of each element of g will be the elements of w).</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" data-line-number="1"><span class="kw">names</span>(g) &lt;-<span class="st"> </span>w</a></code></pre></div>
</details>
<p><strong>If you have time</strong>, continue with Exercise 3b below.<br></p>
</div>
<div id="exercise-3b." class="section level3">
<h3><span class="header-section-number">9.3.2</span> Exercise 3b.</h3>
<p><strong>1- Use the sub() function to replace miRNA with microRNA in the <em>names</em> of g.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" data-line-number="1"><span class="kw">names</span>(g) &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="dt">pattern=</span><span class="st">&quot;miRNA&quot;</span>, <span class="dt">replacement=</span><span class="st">&quot;microRNA&quot;</span>, <span class="dt">x=</span><span class="kw">names</span>(g))</a></code></pre></div>
</details>
<p><strong>2- Count how many microRNAs and mRNAs there are in g based on the column names.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" data-line-number="1"><span class="kw">table</span>(<span class="kw">names</span>(g))</a></code></pre></div>
<pre><code>## 
## microRNA     mRNA 
##        3        2</code></pre>
</details>
<p><strong>3- Create vector tt as:</strong></p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" data-line-number="1">tt &lt;-<span class="st"> &quot;Introduction to R course&quot;</span></a></code></pre></div>
<p>How many characters does tt contain? Use nchar().</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" data-line-number="1"><span class="kw">nchar</span>(tt)</a></code></pre></div>
<pre><code>## [1] 24</code></pre>
</details>
<p><strong>4- Remove “Introduction to R” from tt.</strong>
<br>You can try with either substr() or gsub()</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" data-line-number="1"><span class="kw">substr</span>(<span class="dt">x=</span>tt, <span class="dt">start=</span><span class="dv">17</span>, <span class="dt">stop=</span><span class="kw">nchar</span>(tt))</a></code></pre></div>
<pre><code>## [1] &quot;R course&quot;</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" data-line-number="1"><span class="kw">gsub</span>(<span class="dt">pattern=</span><span class="st">&quot;Introduction to R&quot;</span>, <span class="dt">replacement=</span><span class="st">&quot;&quot;</span>, <span class="dt">x=</span>tt)</a></code></pre></div>
<pre><code>## [1] &quot; course&quot;</code></pre>
</details>

</div>
</div>
<div id="factors" class="section level2">
<h2><span class="header-section-number">9.4</span> Factors</h2>
<ul>
<li><p>A factor is a vector object (1 dimension) used to specify a <strong>discrete classification (grouping)</strong> of the components of other vectors.</p></li>
<li><p>Factors are mainly used for <strong>statistical modeling</strong>, and can also be useful for graphing.</p></li>
<li><p>You can create factors with the <strong>factor</strong> function, for example:</p></li>
</ul>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" data-line-number="1">e &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;high&quot;</span>, <span class="st">&quot;low&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;low&quot;</span>))</a>
<a class="sourceLine" id="cb179-2" data-line-number="2"><span class="co"># check the structure of e</span></a>
<a class="sourceLine" id="cb179-3" data-line-number="3"><span class="kw">str</span>(e)</a></code></pre></div>
<pre><code>##  Factor w/ 3 levels &quot;high&quot;,&quot;low&quot;,&quot;medium&quot;: 1 2 3 2</code></pre>
<ul>
<li>Example of a character vector versus a factor</li>
</ul>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" data-line-number="1"><span class="co"># factor</span></a>
<a class="sourceLine" id="cb181-2" data-line-number="2">e &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;high&quot;</span>, <span class="st">&quot;low&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;low&quot;</span>))</a>
<a class="sourceLine" id="cb181-3" data-line-number="3"><span class="co"># character vector</span></a>
<a class="sourceLine" id="cb181-4" data-line-number="4">e2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;high&quot;</span>, <span class="st">&quot;low&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;low&quot;</span>)</a>
<a class="sourceLine" id="cb181-5" data-line-number="5"><span class="co"># Check the structure of both objects</span></a>
<a class="sourceLine" id="cb181-6" data-line-number="6"><span class="kw">str</span>(e)</a></code></pre></div>
<pre><code>##  Factor w/ 3 levels &quot;high&quot;,&quot;low&quot;,&quot;medium&quot;: 1 2 3 2</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" data-line-number="1"><span class="kw">str</span>(e2)</a></code></pre></div>
<pre><code>##  chr [1:4] &quot;high&quot; &quot;low&quot; &quot;medium&quot; &quot;low&quot;</code></pre>
<ul>
<li>Groups in factors are called <strong>levels</strong>.<br>
Levels can be <strong>ordered</strong>. Then, some operations applied on numeric vectors can be used:</li>
</ul>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" data-line-number="1"><span class="co"># unordered factor:</span></a>
<a class="sourceLine" id="cb185-2" data-line-number="2">e &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;high&quot;</span>, <span class="st">&quot;low&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;low&quot;</span>))</a>
<a class="sourceLine" id="cb185-3" data-line-number="3"><span class="kw">max</span>(e) <span class="co"># throws an error</span></a>
<a class="sourceLine" id="cb185-4" data-line-number="4"><span class="co"># ordered factor</span></a>
<a class="sourceLine" id="cb185-5" data-line-number="5">e_ord &lt;-<span class="st"> </span><span class="kw">factor</span>(e, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;high&quot;</span>), <span class="dt">ordered=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb185-6" data-line-number="6"><span class="kw">max</span>(e_ord) <span class="co"># outputs &quot;high&quot;</span></a></code></pre></div>

</div>
<div id="matrices" class="section level2">
<h2><span class="header-section-number">9.5</span> Matrices</h2>
<ul>
<li><p>A matrix is a <strong>2 dimensional</strong> vector.</p></li>
<li>All columns in a matrix must have:
<ul>
<li>the same <strong>type</strong> (numeric, character or logical)</li>
<li>the same <strong>length</strong></li>
</ul></li>
</ul>
<div id="creating-a-matrix" class="section level3">
<h3><span class="header-section-number">9.5.1</span> Creating a matrix</h3>
<ul>
<li>From vectors with the <strong>rbind</strong> function:</li>
</ul>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb186-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">44</span>)</a>
<a class="sourceLine" id="cb186-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb186-3" data-line-number="3">z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">34</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb186-4" data-line-number="4"><span class="co"># rbind: bind rows</span></a>
<a class="sourceLine" id="cb186-5" data-line-number="5">b &lt;-<span class="st"> </span><span class="kw">rbind</span>(x, y, z)</a></code></pre></div>
<ul>
<li>From vectors with the <strong>cbind</strong> function:</li>
</ul>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" data-line-number="1">i &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">34</span>)</a>
<a class="sourceLine" id="cb187-2" data-line-number="2">j &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">44</span>, <span class="dv">12</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb187-3" data-line-number="3"><span class="co"># cbind: bind columns</span></a>
<a class="sourceLine" id="cb187-4" data-line-number="4">b &lt;-<span class="st"> </span><span class="kw">cbind</span>(i, j)</a></code></pre></div>
<ul>
<li>From scratch with the <em>matrix</em> function:</li>
</ul>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" data-line-number="1"><span class="co"># nrow: number of rows</span></a>
<a class="sourceLine" id="cb188-2" data-line-number="2"><span class="co"># ncol: number of columns</span></a>
<a class="sourceLine" id="cb188-3" data-line-number="3">b &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">34</span>, <span class="dv">44</span>, <span class="dv">12</span>, <span class="dv">4</span>), </a>
<a class="sourceLine" id="cb188-4" data-line-number="4">    <span class="dt">nrow=</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb188-5" data-line-number="5">    <span class="dt">ncol=</span><span class="dv">2</span>)</a></code></pre></div>
</div>
<div id="two-dimensional-object" class="section level3">
<h3><span class="header-section-number">9.5.2</span> Two-dimensional object</h3>
<p>Vectors have one index per element (1-dimension).<br>
Matrices have <strong>two indices (2-dimensions)</strong> per element, corresponding to the row and the column:</p>
<p><img src="images/matrix_indices.png" alt="rstudio logo" width="200"/></p>
<ul>
<li>Fetching elements of a matrix:</li>
</ul>
<p>The “coordinates” of an element in a 2-dimensional object will be first the row (on the left of the comma), then the column (on the right of the comma):</p>
<p><img src="images/matrix_rc.png" alt="rstudio logo" width="200"/></p>
</div>
<div id="matrix-manipulation" class="section level3">
<h3><span class="header-section-number">9.5.3</span> Matrix manipulation</h3>
<ul>
<li>Add 1 to all elements of a matrix</li>
</ul>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" data-line-number="1">b &lt;-<span class="st"> </span>b <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a></code></pre></div>
<ul>
<li>Multiply by 3 all elements of a matrix</li>
</ul>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" data-line-number="1">b &lt;-<span class="st"> </span>b <span class="op">*</span><span class="st"> </span><span class="dv">3</span></a></code></pre></div>
<ul>
<li>Subtract 2 to each element of <strong>the first row</strong> of a matrix</li>
</ul>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" data-line-number="1">b[<span class="dv">1</span>, ] &lt;-<span class="st"> </span>b[<span class="dv">1</span>, ] <span class="op">-</span><span class="st"> </span><span class="dv">2</span></a></code></pre></div>
<ul>
<li>Replace elements that comply a condition:</li>
</ul>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" data-line-number="1"><span class="co"># Replace all elements that are greater than 3 with NA</span></a>
<a class="sourceLine" id="cb192-2" data-line-number="2">b[ b<span class="op">&gt;</span><span class="dv">3</span> ] &lt;-<span class="st"> </span><span class="ot">NA</span></a></code></pre></div>

</div>
</div>
<div id="data-frames" class="section level2">
<h2><span class="header-section-number">9.6</span> Data frames</h2>
<p>A data frame is a 2-dimensional structure.
<br> It is more general than a matrix.
<br><br>
All columns in a data frame:
+ can be of different <strong>types</strong> (numeric, character or logical)
+ must have the same <strong>length</strong></p>
<div id="create-a-data-frame" class="section level3">
<h3><span class="header-section-number">9.6.1</span> Create a data frame</h3>
<ul>
<li>With the <strong>data.frame</strong> function:</li>
</ul>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" data-line-number="1"><span class="co"># stringsAsFactors: ensures that characters are treated as characters and not as factors</span></a>
<a class="sourceLine" id="cb193-2" data-line-number="2">d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">c</span>(<span class="st">&quot;Maria&quot;</span>, <span class="st">&quot;Juan&quot;</span>, <span class="st">&quot;Alba&quot;</span>), </a>
<a class="sourceLine" id="cb193-3" data-line-number="3">    <span class="kw">c</span>(<span class="dv">23</span>, <span class="dv">25</span>, <span class="dv">31</span>),</a>
<a class="sourceLine" id="cb193-4" data-line-number="4">    <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb193-5" data-line-number="5">    <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<ul>
<li>Example why “stringsAsFactors = FALSE” is useful</li>
</ul>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" data-line-number="1"><span class="co"># Create a data frame with default parameters</span></a>
<a class="sourceLine" id="cb194-2" data-line-number="2">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">label=</span><span class="kw">rep</span>(<span class="st">&quot;test&quot;</span>,<span class="dv">5</span>), <span class="dt">column2=</span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb194-3" data-line-number="3"><span class="co"># Replace one value</span></a>
<a class="sourceLine" id="cb194-4" data-line-number="4">df[<span class="dv">2</span>,<span class="dv">1</span>] &lt;-<span class="st"> &quot;yes&quot;</span></a></code></pre></div>
<pre><code>## Warning in `[&lt;-.factor`(`*tmp*`, iseq, value = &quot;yes&quot;): invalid factor
## level, NA generated</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" data-line-number="1"><span class="co"># Throws an error and doesn&#39;t replace the value !</span></a></code></pre></div>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" data-line-number="1"><span class="co"># Create a data frame with </span></a>
<a class="sourceLine" id="cb197-2" data-line-number="2">df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">label=</span><span class="kw">rep</span>(<span class="st">&quot;test&quot;</span>,<span class="dv">5</span>), <span class="dt">column2=</span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb197-3" data-line-number="3"><span class="co"># Replace one value</span></a>
<a class="sourceLine" id="cb197-4" data-line-number="4">df2[<span class="dv">2</span>,<span class="dv">1</span>] &lt;-<span class="st"> &quot;yes&quot;</span></a>
<a class="sourceLine" id="cb197-5" data-line-number="5"><span class="co"># Works!</span></a></code></pre></div>
<ul>
<li>Converting a matrix into a data frame:</li>
</ul>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" data-line-number="1"><span class="co"># create a matrix</span></a>
<a class="sourceLine" id="cb198-2" data-line-number="2">b &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">34</span>, <span class="dv">44</span>, <span class="dv">12</span>, <span class="dv">4</span>), </a>
<a class="sourceLine" id="cb198-3" data-line-number="3">        <span class="dt">nrow=</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb198-4" data-line-number="4">        <span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb198-5" data-line-number="5"><span class="co"># convert as data frame</span></a>
<a class="sourceLine" id="cb198-6" data-line-number="6">b_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(b)</a></code></pre></div>
</div>
<div id="data-frame-manipulation" class="section level3">
<h3><span class="header-section-number">9.6.2</span> Data frame manipulation:</h3>
<p><br>
Very similar to matrix manipulation.</p>
<p><img src="images/df_fetch.png" width="450"/></p>

</div>
</div>
<div id="two-dimensional-structures-manipulation" class="section level2">
<h2><span class="header-section-number">9.7</span> Two-dimensional structures manipulation</h2>
<div id="dimensions" class="section level3">
<h3><span class="header-section-number">9.7.1</span> Dimensions</h3>
<ul>
<li>Get the number of rows and the number of columns:</li>
</ul>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" data-line-number="1"><span class="co"># Create a data frame</span></a>
<a class="sourceLine" id="cb199-2" data-line-number="2">d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">c</span>(<span class="st">&quot;Maria&quot;</span>, <span class="st">&quot;Juan&quot;</span>, <span class="st">&quot;Alba&quot;</span>),</a>
<a class="sourceLine" id="cb199-3" data-line-number="3">    <span class="kw">c</span>(<span class="dv">23</span>, <span class="dv">25</span>, <span class="dv">31</span>),</a>
<a class="sourceLine" id="cb199-4" data-line-number="4">    <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb199-5" data-line-number="5">    <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb199-6" data-line-number="6"><span class="co"># number of rows</span></a>
<a class="sourceLine" id="cb199-7" data-line-number="7"><span class="kw">nrow</span>(d)</a></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" data-line-number="1"><span class="co"># number of columns</span></a>
<a class="sourceLine" id="cb201-2" data-line-number="2"><span class="kw">ncol</span>(d)</a></code></pre></div>
<pre><code>## [1] 3</code></pre>
<ul>
<li>Check the dimensions of the object: both number of rows and number of columns:</li>
</ul>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" data-line-number="1"><span class="co"># first element: number of rows</span></a>
<a class="sourceLine" id="cb203-2" data-line-number="2"><span class="co"># second element: number of columns</span></a>
<a class="sourceLine" id="cb203-3" data-line-number="3"><span class="kw">dim</span>(d)</a></code></pre></div>
<pre><code>## [1] 3 3</code></pre>
<ul>
<li>Dimension names</li>
</ul>
<p>Column and/or row names can be added to matrices and data frames</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" data-line-number="1"><span class="kw">colnames</span>(d) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Name&quot;</span>, <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Vegetarian&quot;</span>)</a>
<a class="sourceLine" id="cb205-2" data-line-number="2"><span class="kw">rownames</span>(d) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Patient1&quot;</span>, <span class="st">&quot;Patient2&quot;</span>, <span class="st">&quot;Patient3&quot;</span>)</a></code></pre></div>
<p>Column and/or row names can be used to retrieve elements or sets of elements from a 2-dimensional object:</p>
<p><img src="images/df_names.png" width="450"/></p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" data-line-number="1">d[,<span class="st">&quot;Name&quot;</span>]</a></code></pre></div>
<pre><code>## [1] &quot;Maria&quot; &quot;Juan&quot;  &quot;Alba&quot;</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" data-line-number="1"><span class="co"># same as:</span></a>
<a class="sourceLine" id="cb208-2" data-line-number="2">d[,<span class="dv">1</span>]</a></code></pre></div>
<pre><code>## [1] &quot;Maria&quot; &quot;Juan&quot;  &quot;Alba&quot;</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" data-line-number="1">d[<span class="st">&quot;Patient3&quot;</span>, <span class="st">&quot;Age&quot;</span>]</a></code></pre></div>
<pre><code>## [1] 31</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" data-line-number="1"><span class="co"># same as:</span></a>
<a class="sourceLine" id="cb212-2" data-line-number="2">d[<span class="dv">3</span>,<span class="dv">2</span>]</a></code></pre></div>
<pre><code>## [1] 31</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" data-line-number="1"><span class="co"># for data frames only, the $ sign can be used to retrieve columns:</span></a>
<a class="sourceLine" id="cb214-2" data-line-number="2"><span class="co"># d$Name is d[,1] is d[, &quot;Name&quot;]</span></a></code></pre></div>
<ul>
<li>Include names as you create objects:
<ul>
<li>Matrix:</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" data-line-number="1">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">2</span>, </a>
<a class="sourceLine" id="cb215-2" data-line-number="2">    <span class="dt">dimnames=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;row1&quot;</span>, <span class="st">&quot;row2&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;col1&quot;</span>, <span class="st">&quot;col2&quot;</span>)))</a></code></pre></div>
<pre><code>+ Data frame:</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">col1=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">col2=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, </a>
<a class="sourceLine" id="cb217-2" data-line-number="2">    <span class="dt">row.names=</span><span class="kw">c</span>(<span class="st">&quot;row1&quot;</span>, <span class="st">&quot;row2&quot;</span>))</a></code></pre></div>
</div>
<div id="manipulation" class="section level3">
<h3><span class="header-section-number">9.7.2</span> Manipulation</h3>
<p>Same principle as vectors… but in 2 dimensions!
<br></p>
<h4>
Examples
</h4>
<ul>
<li>select the columns of b if <strong>at least one element in the 3rd row is less than or equal to 4</strong>:</li>
</ul>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb218-1" data-line-number="1"><span class="co"># create b</span></a>
<a class="sourceLine" id="cb218-2" data-line-number="2">b &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">34</span>, <span class="dv">44</span>, <span class="dv">12</span>, <span class="dv">4</span>), </a>
<a class="sourceLine" id="cb218-3" data-line-number="3">    <span class="dt">nrow=</span><span class="dv">3</span>, </a>
<a class="sourceLine" id="cb218-4" data-line-number="4">    <span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb218-5" data-line-number="5"><span class="co"># third row of b:</span></a>
<a class="sourceLine" id="cb218-6" data-line-number="6">b[<span class="dv">3</span>, ]</a></code></pre></div>
<pre><code>## [1] 34  4</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb220-1" data-line-number="1"><span class="co"># element(s) in the third row of b that is (are) less than or equal to 4</span></a>
<a class="sourceLine" id="cb220-2" data-line-number="2">b[<span class="dv">3</span>, ] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">4</span></a></code></pre></div>
<pre><code>## [1] FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb222-1" data-line-number="1"><span class="co"># retrieve the corresponding sub-matrix</span></a>
<a class="sourceLine" id="cb222-2" data-line-number="2">b[ ,b[<span class="dv">3</span>, ] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">4</span>]</a></code></pre></div>
<pre><code>## [1] 44 12  4</code></pre>
<ul>
<li>Select rows of b if <strong>at least one element in column 2 is greater than 24</strong>:</li>
</ul>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" data-line-number="1"><span class="co"># build data frame d</span></a>
<a class="sourceLine" id="cb224-2" data-line-number="2">d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Name=</span><span class="kw">c</span>(<span class="st">&quot;Maria&quot;</span>, <span class="st">&quot;Juan&quot;</span>, <span class="st">&quot;Alba&quot;</span>), </a>
<a class="sourceLine" id="cb224-3" data-line-number="3">        <span class="dt">Age=</span><span class="kw">c</span>(<span class="dv">23</span>, <span class="dv">25</span>, <span class="dv">31</span>),</a>
<a class="sourceLine" id="cb224-4" data-line-number="4">        <span class="dt">Vegetarian=</span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb224-5" data-line-number="5">        <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb224-6" data-line-number="6"><span class="kw">rownames</span>(d) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Patient1&quot;</span>, <span class="st">&quot;Patient2&quot;</span>, <span class="st">&quot;Patient3&quot;</span>)</a>
<a class="sourceLine" id="cb224-7" data-line-number="7"><span class="co"># The following commands all output the same result:</span></a>
<a class="sourceLine" id="cb224-8" data-line-number="8">d[d[,<span class="dv">2</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">24</span>, ]</a></code></pre></div>
<pre><code>##          Name Age Vegetarian
## Patient2 Juan  25       TRUE
## Patient3 Alba  31      FALSE</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" data-line-number="1">d[d[,<span class="st">&quot;Age&quot;</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">24</span>, ]</a></code></pre></div>
<pre><code>##          Name Age Vegetarian
## Patient2 Juan  25       TRUE
## Patient3 Alba  31      FALSE</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" data-line-number="1">d[d<span class="op">$</span>Age <span class="op">&gt;</span><span class="st"> </span><span class="dv">24</span>, ]</a></code></pre></div>
<pre><code>##          Name Age Vegetarian
## Patient2 Juan  25       TRUE
## Patient3 Alba  31      FALSE</code></pre>
<p><img src="images/df_col2.png" width="450"/></p>
<ul>
<li>Select patients (rows) based on 2 criteria: age of the patient (column 2) should be great than or equal to 25, and the patient should be vegetarian (column 3):</li>
</ul>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" data-line-number="1">d[ d<span class="op">$</span>Age <span class="op">&gt;=</span><span class="st"> </span><span class="dv">25</span> <span class="op">&amp;</span><span class="st"> </span>d<span class="op">$</span>Vegetarian <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>, ]</a></code></pre></div>
<pre><code>##          Name Age Vegetarian
## Patient2 Juan  25       TRUE</code></pre>
<p><img src="images/df_col2_col3.png" width="650"/></p>
<h4>
More useful commands
</h4>
<ul>
<li>Add a row or a column with <strong>rbind</strong> and <strong>cbind</strong>, respectively</li>
</ul>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" data-line-number="1"><span class="co"># add a column</span></a>
<a class="sourceLine" id="cb232-2" data-line-number="2"><span class="kw">cbind</span>(d, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>##           Name Age Vegetarian 1:3
## Patient1 Maria  23       TRUE   1
## Patient2  Juan  25       TRUE   2
## Patient3  Alba  31      FALSE   3</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" data-line-number="1"><span class="co"># add a row</span></a>
<a class="sourceLine" id="cb234-2" data-line-number="2"><span class="kw">rbind</span>(d, <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>)</a></code></pre></div>
<pre><code>##           Name Age Vegetarian
## Patient1 Maria  23          1
## Patient2  Juan  25          1
## Patient3  Alba  31          0
## 4            4   5          6</code></pre>
<p>Add a patient to our data frame <strong>d</strong>:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" data-line-number="1">d &lt;-<span class="st"> </span><span class="kw">rbind</span>(d, <span class="kw">c</span>(<span class="st">&quot;Jordi&quot;</span>, <span class="dv">33</span>, <span class="ot">FALSE</span>))</a></code></pre></div>
<ul>
<li>Process the sum of all rows or all columns with <strong>rowSums</strong> and <strong>colSums</strong>, respectively.</li>
</ul>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb237-1" data-line-number="1"><span class="co"># create a matrix</span></a>
<a class="sourceLine" id="cb237-2" data-line-number="2">b &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb237-3" data-line-number="3"><span class="co"># process sum of rows and sum of cols</span></a>
<a class="sourceLine" id="cb237-4" data-line-number="4"><span class="kw">rowSums</span>(b)</a></code></pre></div>
<pre><code>## [1] 34 38 42 46 50</code></pre>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb239-1" data-line-number="1"><span class="kw">colSums</span>(b)</a></code></pre></div>
<pre><code>## [1] 15 40 65 90</code></pre>
<ul>
<li>The <strong>apply</strong> function</li>
</ul>
<p>Powerful tool to apply a command to all rows or all columns of a data frame or a matrix.<br>
For example, instead of calculating the sum of each row, you might be interested in calculating the median ? But rowMedians doesn’t exist !
<br><br>
<strong>apply</strong> takes 3 arguments:
- first argument <strong>X</strong>: 2-dimensional object
- second argument <strong>MARGIN</strong>: apply by row or by column?
+ 1: by row
+ 2: by column
- third argument <strong>FUN</strong>: function to apply to either rows or columns</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb241-1" data-line-number="1"><span class="co"># median value of each row of b</span></a>
<a class="sourceLine" id="cb241-2" data-line-number="2"><span class="kw">apply</span>(<span class="dt">X=</span>b, <span class="dt">MARGIN=</span><span class="dv">1</span>, <span class="dt">FUN=</span>median)</a></code></pre></div>
<pre><code>## [1]  8.5  9.5 10.5 11.5 12.5</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb243-1" data-line-number="1"><span class="co"># median value of each column of b</span></a>
<a class="sourceLine" id="cb243-2" data-line-number="2"><span class="kw">apply</span>(<span class="dt">X=</span>b, <span class="dt">MARGIN=</span><span class="dv">2</span>, <span class="dt">FUN=</span>median)</a></code></pre></div>
<pre><code>## [1]  3  8 13 18</code></pre>

</div>
</div>
<div id="exercise-4.-matrix-manipulation" class="section level2">
<h2><span class="header-section-number">9.8</span> Exercise 4. Matrix manipulation</h2>
<p>Create the script “exercise4.R” and save it to the “Rcourse/Module1” directory: you will save all the commands of exercise 4 in that script.
<br>Remember you can comment the code using #.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb245-1" data-line-number="1"><span class="kw">getwd</span>()</a>
<a class="sourceLine" id="cb245-2" data-line-number="2"><span class="kw">setwd</span>(<span class="st">&quot;Rcourse/Module1&quot;</span>)</a>
<a class="sourceLine" id="cb245-3" data-line-number="3"><span class="kw">setwd</span>(<span class="st">&quot;~/Rcourse/Module1&quot;</span>)</a></code></pre></div>
</details>
<p><strong>1- Create three numeric vectors x, y, z, each of 4 elements of your choice.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb246-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb246-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="dv">6</span><span class="op">:</span><span class="dv">9</span></a>
<a class="sourceLine" id="cb246-3" data-line-number="3">z &lt;-<span class="st"> </span><span class="dv">7</span><span class="op">:</span><span class="dv">4</span></a></code></pre></div>
</details>
<p>Use rbind() to create a matrix <strong>mat</strong> (3 rows and 4 columns) out of x, y and z.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb247-1" data-line-number="1">mat &lt;-<span class="st"> </span><span class="kw">rbind</span>(x, y, z)</a></code></pre></div>
</details>
<p><strong>2- Create the same matrix now using the matrix function.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb248-1" data-line-number="1">mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data=</span><span class="kw">c</span>(x, y, z), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb248-2" data-line-number="2"><span class="co"># Try with the &quot;byrow=TRUE&quot; parameter: what is different ?</span></a>
<a class="sourceLine" id="cb248-3" data-line-number="3">mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data=</span><span class="kw">c</span>(x, y, z), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">4</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a></code></pre></div>
</details>
<p><strong>3- Add names to mat’s columns: “a”, “b”, “c”, “d”, respectively.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb249-1" data-line-number="1"><span class="kw">colnames</span>(mat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>)</a></code></pre></div>
</details>
<p><strong>4- Calculate the sum of each row, and the sum of each column</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" data-line-number="1"><span class="kw">rowSums</span>(mat); <span class="kw">colSums</span>(mat)</a></code></pre></div>
<pre><code>## [1] 14 30 22</code></pre>
<pre><code>##  a  b  c  d 
## 15 16 17 18</code></pre>
</details>
<p><strong>5- Create the matrix mat2 as:</strong></p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb253-1" data-line-number="1">mat2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">1</span>, <span class="dt">to=</span><span class="dv">10</span>, <span class="dt">by=</span><span class="dv">2</span>), <span class="dv">5</span><span class="op">:</span><span class="dv">1</span>, <span class="kw">rep</span>(<span class="dt">x=</span><span class="dv">2017</span>, <span class="dt">times=</span><span class="dv">5</span>)), <span class="dt">ncol=</span><span class="dv">3</span>)</a></code></pre></div>
<p>What does function seq() do?</p>
<details>
<p><summary>
correction
</summary></p>
<p><strong>seq</strong> generate sequences of numbers. Here, it creates a sequences from 1 to 10 with a step of 2 numbers.</p>
</details>
<p><strong>6- What are the dimensions of mat2 (number of rows and number of columns)?</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb254-1" data-line-number="1"><span class="co"># number of rows</span></a>
<a class="sourceLine" id="cb254-2" data-line-number="2"><span class="kw">nrow</span>(mat2)</a></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb256-1" data-line-number="1"><span class="co"># number of columns</span></a>
<a class="sourceLine" id="cb256-2" data-line-number="2"><span class="kw">ncol</span>(mat2)</a></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb258-1" data-line-number="1"><span class="co"># dimensions: number of rows, number of columns</span></a>
<a class="sourceLine" id="cb258-2" data-line-number="2"><span class="kw">dim</span>(mat2)</a></code></pre></div>
<pre><code>## [1] 5 3</code></pre>
</details>
<p><strong>7- Add column names to mat2: “day”, “month” and “year”, respectively.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb260-1" data-line-number="1"><span class="kw">colnames</span>(mat2) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;day&quot;</span>, <span class="st">&quot;month&quot;</span>, <span class="st">&quot;year&quot;</span>)</a></code></pre></div>
</details>
<p><strong>8- Add row names to mat2: letters “A” to “E”</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb261-1" data-line-number="1"><span class="kw">rownames</span>(mat2) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>)</a>
<a class="sourceLine" id="cb261-2" data-line-number="2"><span class="kw">rownames</span>(mat2) &lt;-<span class="st"> </span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a></code></pre></div>
</details>
<p><strong>9- Shows row(s) of mat2 where the month column is greater than or equal to 3.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb262-1" data-line-number="1"><span class="co"># select column month</span></a>
<a class="sourceLine" id="cb262-2" data-line-number="2">mat2[, <span class="st">&quot;month&quot;</span>]</a></code></pre></div>
<pre><code>## A B C D E 
## 5 4 3 2 1</code></pre>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb264-1" data-line-number="1"><span class="co"># element(s) of column month that is (are) greater than or equal to 3</span></a>
<a class="sourceLine" id="cb264-2" data-line-number="2">mat2[,<span class="st">&quot;month&quot;</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span></a></code></pre></div>
<pre><code>##     A     B     C     D     E 
##  TRUE  TRUE  TRUE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb266-1" data-line-number="1"><span class="co"># finally select row(s) where the month columns is greater than or equal to 3</span></a>
<a class="sourceLine" id="cb266-2" data-line-number="2">mat2[mat2[,<span class="st">&quot;month&quot;</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>,]</a></code></pre></div>
<pre><code>##   day month year
## A   1     5 2017
## B   3     4 2017
## C   5     3 2017</code></pre>
</details>
<p><strong>10- Replace all elements of mat2 that are equal to 2017 with 2018.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb268-1" data-line-number="1"><span class="co"># which elements of mat2 that are exactly equal to 2017</span></a>
<a class="sourceLine" id="cb268-2" data-line-number="2">mat2<span class="op">==</span><span class="dv">2017</span></a></code></pre></div>
<pre><code>##     day month year
## A FALSE FALSE TRUE
## B FALSE FALSE TRUE
## C FALSE FALSE TRUE
## D FALSE FALSE TRUE
## E FALSE FALSE TRUE</code></pre>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb270-1" data-line-number="1"><span class="co"># retrieve actual elements</span></a>
<a class="sourceLine" id="cb270-2" data-line-number="2">mat2[mat2<span class="op">==</span><span class="dv">2017</span>]</a></code></pre></div>
<pre><code>## [1] 2017 2017 2017 2017 2017</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" data-line-number="1"><span class="co"># replace all 2017 with 2018</span></a>
<a class="sourceLine" id="cb272-2" data-line-number="2">mat2[mat2<span class="op">==</span><span class="dv">2017</span>] &lt;-<span class="st"> </span><span class="dv">2018</span></a></code></pre></div>
</details>
<p><strong>11- Multiply all elements of the 2nd column of mat2 by 7. Reassign mat2!</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb273-1" data-line-number="1"><span class="co"># multiply all elements of the 2nd column of mat2 by 7</span></a>
<a class="sourceLine" id="cb273-2" data-line-number="2">mat2[,<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">7</span></a></code></pre></div>
<pre><code>##  A  B  C  D  E 
## 35 28 21 14  7</code></pre>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb275-1" data-line-number="1"><span class="co"># reassign mat2 with the new values of column 2</span></a>
<a class="sourceLine" id="cb275-2" data-line-number="2">mat2[,<span class="dv">2</span>] &lt;-<span class="st"> </span>mat2[,<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">7</span></a></code></pre></div>
</details>
<p><strong>12- Add the column named “time” to mat2, that contains values 8, 12, 11, 10, 8. Save in the new object mat3.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb276-1" data-line-number="1">mat3 &lt;-<span class="st"> </span><span class="kw">cbind</span>(mat2, <span class="dt">time=</span><span class="kw">c</span>(<span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">10</span>, <span class="dv">8</span>))</a></code></pre></div>
</details>
<p><strong>13- Replace all elements of mat3 that are less than 3 with NA.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb277-1" data-line-number="1"><span class="co"># which elements of mat3 that are less than 3</span></a>
<a class="sourceLine" id="cb277-2" data-line-number="2">mat3 <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span></a></code></pre></div>
<pre><code>##     day month  year  time
## A  TRUE FALSE FALSE FALSE
## B FALSE FALSE FALSE FALSE
## C FALSE FALSE FALSE FALSE
## D FALSE FALSE FALSE FALSE
## E FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb279-1" data-line-number="1"><span class="co"># actually elements of mat3 that are less than 3</span></a>
<a class="sourceLine" id="cb279-2" data-line-number="2">mat3[mat3 <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>]</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb281-1" data-line-number="1"><span class="co"># reassign elements of mat3 that are less than 3 with NA</span></a>
<a class="sourceLine" id="cb281-2" data-line-number="2">mat3[mat3 <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a></code></pre></div>
</details>
<p><strong>14- Remove rows from mat3 if a NA is present. Save in the new object mat4.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb282-1" data-line-number="1">mat4 &lt;-<span class="st"> </span><span class="kw">na.omit</span>(mat3)</a></code></pre></div>
</details>
<p><strong>15- Retrieve the smaller value of each column of mat4.</strong></p>
<p>Try different approaches:</p>
<ul>
<li>Retrieve the minimum for each column one by one.</li>
</ul>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb283-1" data-line-number="1"><span class="kw">min</span>(mat4[,<span class="st">&quot;day&quot;</span>])</a></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb285-1" data-line-number="1"><span class="kw">min</span>(mat4[,<span class="st">&quot;month&quot;</span>])</a></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb287-1" data-line-number="1"><span class="kw">min</span>(mat4[,<span class="st">&quot;year&quot;</span>])</a></code></pre></div>
<pre><code>## [1] 2018</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb289-1" data-line-number="1"><span class="kw">min</span>(mat4[,<span class="st">&quot;time&quot;</span>])</a></code></pre></div>
<pre><code>## [1] 8</code></pre>
</details>
<ul>
<li>Retrieve the minimum of all columns simultaneously using the apply() function.</li>
</ul>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" data-line-number="1"><span class="co"># mat4: object</span></a>
<a class="sourceLine" id="cb291-2" data-line-number="2"><span class="co"># 2: by column</span></a>
<a class="sourceLine" id="cb291-3" data-line-number="3"><span class="co"># min: function to apply</span></a>
<a class="sourceLine" id="cb291-4" data-line-number="4"><span class="kw">apply</span>(mat4, <span class="dv">2</span>, min)</a></code></pre></div>
<pre><code>##   day month  year  time 
##     3     7  2018     8</code></pre>
</details>

</div>
<div id="exercise-5.-data-frame-manipulation" class="section level2">
<h2><span class="header-section-number">9.9</span> Exercise 5. Data frame manipulation</h2>
<p>Create the script “exercise5.R” and save it to the “Rcourse/Module1” directory: you will save all the commands of exercise 5 in that script.
<br>Remember you can comment the code using #.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb293-1" data-line-number="1"><span class="kw">getwd</span>()</a>
<a class="sourceLine" id="cb293-2" data-line-number="2"><span class="kw">setwd</span>(<span class="st">&quot;Rcourse/Module1&quot;</span>)</a>
<a class="sourceLine" id="cb293-3" data-line-number="3"><span class="kw">setwd</span>(<span class="st">&quot;~/Rcourse/Module1&quot;</span>)</a></code></pre></div>
</details>
<div id="exercise-5a" class="section level3">
<h3><span class="header-section-number">9.9.1</span> Exercise 5a</h3>
<p><strong>1- Create the following data frame:</strong></p>
<p>|43|181|M|
|34|172|F|
|22|189|M|
|27|167|F|</p>
<p><br>
With Row names: John, Jessica, Steve, Rachel.
<br>
And Column names: Age, Height, Sex.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb294-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Age=</span><span class="kw">c</span>(<span class="dv">43</span>, <span class="dv">34</span>, <span class="dv">22</span>, <span class="dv">27</span>), </a>
<a class="sourceLine" id="cb294-2" data-line-number="2">                 <span class="dt">Height=</span><span class="kw">c</span>(<span class="dv">181</span>, <span class="dv">172</span>, <span class="dv">189</span>, <span class="dv">167</span>),</a>
<a class="sourceLine" id="cb294-3" data-line-number="3">                 <span class="dt">Sex=</span><span class="kw">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>),</a>
<a class="sourceLine" id="cb294-4" data-line-number="4">                 <span class="dt">row.names =</span> <span class="kw">c</span>(<span class="st">&quot;John&quot;</span>, <span class="st">&quot;Jessica&quot;</span>, <span class="st">&quot;Steve&quot;</span>, <span class="st">&quot;Rachel&quot;</span>),</a>
<a class="sourceLine" id="cb294-5" data-line-number="5">                 <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>)</a></code></pre></div>
</details>
<p><strong>2- Check the structure of df with str().</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" data-line-number="1"><span class="kw">str</span>(df)</a></code></pre></div>
</details>
<p><strong>3- Calculate the average age and height in df</strong></p>
<p>Try different approaches:
* Calculate the average for each column separately.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb296-1" data-line-number="1"><span class="kw">mean</span>(df<span class="op">$</span>Age)</a>
<a class="sourceLine" id="cb296-2" data-line-number="2"><span class="kw">mean</span>(df<span class="op">$</span>Height)</a></code></pre></div>
</details>
<ul>
<li>Calculate the average of both columns simultaneously using the apply() function.</li>
</ul>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb297-1" data-line-number="1"><span class="co"># we have to remove the Sex column: we can calculate the average only with numbers</span></a>
<a class="sourceLine" id="cb297-2" data-line-number="2"><span class="kw">apply</span>(df[,<span class="op">-</span><span class="dv">3</span>], <span class="dv">2</span>, mean)</a>
<a class="sourceLine" id="cb297-3" data-line-number="3"><span class="kw">apply</span>(df[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">2</span>, mean)</a>
<a class="sourceLine" id="cb297-4" data-line-number="4"><span class="kw">apply</span>(df[,<span class="op">-</span><span class="kw">grep</span>(<span class="st">&quot;Sex&quot;</span>, <span class="kw">colnames</span>(df))], <span class="dv">2</span>, mean)</a></code></pre></div>
</details>
<p><strong>4- Add one row to df2: Georges who is 53 years old and 168 tall.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb298-1" data-line-number="1"><span class="co"># Georges= allows us to enter the row name at the same time as we add a row</span></a>
<a class="sourceLine" id="cb298-2" data-line-number="2">df &lt;-<span class="st"> </span><span class="kw">rbind</span>(df, <span class="dt">Georges=</span><span class="kw">c</span>(<span class="dv">53</span>, <span class="dv">168</span>, <span class="st">&quot;M&quot;</span>))</a></code></pre></div>
</details>
<p><strong>5- Change the row names of df so the data becomes anonymous:</strong>
Use Patient1, Patient2, etc. instead of actual names.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb299-1" data-line-number="1"><span class="kw">rownames</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Patient1&quot;</span>, <span class="st">&quot;Patient2&quot;</span>, <span class="st">&quot;Patient3&quot;</span>, <span class="st">&quot;Patient4&quot;</span>, <span class="st">&quot;Patient5&quot;</span>)</a>
<a class="sourceLine" id="cb299-2" data-line-number="2"><span class="co"># try also the paste function!</span></a>
<a class="sourceLine" id="cb299-3" data-line-number="3"><span class="kw">rownames</span>(df) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Patient&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a></code></pre></div>
</details>
<p><strong>6- Create the data frame df2 that is a subset of df which will contain only the female entries.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb300-1" data-line-number="1"><span class="co"># which elements are female (&quot;F&quot; in the &quot;Sex&quot; colum)</span></a>
<a class="sourceLine" id="cb300-2" data-line-number="2">df<span class="op">$</span>Sex<span class="op">==</span><span class="st">&quot;F&quot;</span></a>
<a class="sourceLine" id="cb300-3" data-line-number="3"><span class="co"># retrieve rows that contain the female entries, and save in df2</span></a>
<a class="sourceLine" id="cb300-4" data-line-number="4">df2 &lt;-<span class="st"> </span>df[df<span class="op">$</span>Sex<span class="op">==</span><span class="st">&quot;F&quot;</span>,]</a></code></pre></div>
</details>
<p><strong>7- Create the data frame df3 that is a subset of df which will contain only entries of males taller than 170.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb301-1" data-line-number="1"><span class="co"># which entries are males</span></a>
<a class="sourceLine" id="cb301-2" data-line-number="2">df<span class="op">$</span>Sex<span class="op">==</span><span class="st">&quot;M&quot;</span></a>
<a class="sourceLine" id="cb301-3" data-line-number="3"><span class="co"># which entries are greater than 170 in column &quot;Height&quot;</span></a>
<a class="sourceLine" id="cb301-4" data-line-number="4">df<span class="op">$</span>Sex<span class="op">==</span><span class="st">&quot;M&quot;</span> <span class="op">&amp;</span><span class="st"> </span>df<span class="op">$</span>Height <span class="op">&gt;</span><span class="st"> </span><span class="dv">170</span></a>
<a class="sourceLine" id="cb301-5" data-line-number="5"><span class="co"># retrieve rows that contain the males that are taller than 170, and save in df3</span></a>
<a class="sourceLine" id="cb301-6" data-line-number="6">df3 &lt;-<span class="st"> </span>df[df<span class="op">$</span>Sex<span class="op">==</span><span class="st">&quot;M&quot;</span> <span class="op">&amp;</span><span class="st"> </span>df<span class="op">$</span>Height <span class="op">&gt;</span><span class="st"> </span><span class="dv">170</span>,]</a></code></pre></div>
</details>
</div>
<div id="exercise-5b" class="section level3">
<h3><span class="header-section-number">9.9.2</span> Exercise 5b</h3>
<p><strong>1. Create two data frames mydf1 and mydf2 as:</strong></p>
<p>mydf1:</p>
<p>|1|14|
|2|12|
|3|15|
|4|10|</p>
<p>mydf2:</p>
<p>|1|paul|
|2|helen|
|3|emily|
|4|john|
|5|mark|</p>
<p>With column names: <strong>“id”, “age”</strong> for mydf1, and <strong>“id”, “name”</strong> for mydf2.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb302-1" data-line-number="1">mydf1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">age=</span><span class="kw">c</span>(<span class="dv">14</span>,<span class="dv">12</span>,<span class="dv">15</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb302-2" data-line-number="2">mydf2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id=</span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">name=</span><span class="kw">c</span>(<span class="st">&quot;paul&quot;</span>, <span class="st">&quot;helen&quot;</span>, <span class="st">&quot;emily&quot;</span>, <span class="st">&quot;john&quot;</span>, <span class="st">&quot;mark&quot;</span>))</a></code></pre></div>
</details>
<p><strong>2- Merge mydf1 and mydf2 by their “id” column.</strong>
Look for the help page of <strong>merge</strong> and/or Google it!</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb303-1" data-line-number="1"><span class="co"># input 2 data frames</span></a>
<a class="sourceLine" id="cb303-2" data-line-number="2"><span class="co"># &quot;by&quot; columns indicate by which column you want to merge the data</span></a>
<a class="sourceLine" id="cb303-3" data-line-number="3"><span class="kw">merge</span>(<span class="dt">x=</span>mydf1, <span class="dt">y=</span>mydf2, <span class="dt">by.x=</span><span class="st">&quot;id&quot;</span>, <span class="dt">by.y=</span><span class="st">&quot;id&quot;</span>)</a>
<a class="sourceLine" id="cb303-4" data-line-number="4">mydf3 &lt;-<span class="st"> </span><span class="kw">merge</span>(<span class="dt">x=</span>mydf1, <span class="dt">y=</span>mydf2, <span class="dt">by=</span><span class="st">&quot;id&quot;</span>)</a></code></pre></div>
</details>
<p><strong>3- Order mydf3 by decreasing age.</strong>
Look for the help page of <strong>order</strong>.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb304-1" data-line-number="1"><span class="co"># order the age column (default is increasing order)</span></a>
<a class="sourceLine" id="cb304-2" data-line-number="2"><span class="kw">order</span>(mydf3<span class="op">$</span>age)</a>
<a class="sourceLine" id="cb304-3" data-line-number="3"><span class="co"># order the age column by decreasing order</span></a>
<a class="sourceLine" id="cb304-4" data-line-number="4"><span class="kw">order</span>(mydf3<span class="op">$</span>age, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb304-5" data-line-number="5"><span class="co"># order the whole data frame by the column age in decreasing order</span></a>
<a class="sourceLine" id="cb304-6" data-line-number="6">mydf3[<span class="kw">order</span>(mydf3<span class="op">$</span>age, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>), ]</a></code></pre></div>
</details>
</div>
<div id="exercise-5c" class="section level3">
<h3><span class="header-section-number">9.9.3</span> Exercise 5c</h3>
<p><strong>1- Using the download.file function, download <a href="https://public-docs.crg.es/biocore/sbonnin/Rcourse/genes_dataframe.RData">this file</a> to your current directory.</strong> (Right click on “this file” -&gt; Copy link location to get the full path).</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb305-1" data-line-number="1"><span class="co"># failing: download.file(&quot;https://github.com/sbcrg/CRG_RIntroduction/blob/master/genes_dataframe.RData&quot;, &quot;genes_dataframe.RData&quot;)</span></a>
<a class="sourceLine" id="cb305-2" data-line-number="2"><span class="kw">download.file</span>(<span class="st">&quot;https://public-docs.crg.es/biocore/sbonnin/Rcourse/genes_dataframe.RData&quot;</span>, <span class="st">&quot;genes_dataframe.RData&quot;</span>)</a></code></pre></div>
</details>
<p><strong>2- The function dir() lists the files and directories present in the current directory: check if genes_dataframe.RData was copied.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb306-1" data-line-number="1"><span class="kw">dir</span>()</a></code></pre></div>
</details>
<p><strong>3- Load genes_dataframe.RData in your environment</strong>
Use the <em>load</em> function.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb307-1" data-line-number="1"><span class="kw">load</span>(<span class="st">&quot;genes_dataframe.RData&quot;</span>)</a></code></pre></div>
</details>
<p><strong>4- genes_dataframe.RData contains the df_genes object: is it now present in your environment?</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb308-1" data-line-number="1"><span class="kw">ls</span>()</a></code></pre></div>
</details>
<p><strong>5- Explore df_genes and see what it contains</strong>
You can use a variety of functions: str, head, tail, dim, colnames, rownames, class…</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb309-1" data-line-number="1"><span class="kw">str</span>(df_genes)</a>
<a class="sourceLine" id="cb309-2" data-line-number="2"><span class="kw">head</span>(df_genes)</a>
<a class="sourceLine" id="cb309-3" data-line-number="3"><span class="kw">tail</span>(df_genes)</a>
<a class="sourceLine" id="cb309-4" data-line-number="4"><span class="kw">dim</span>(df_genes)</a>
<a class="sourceLine" id="cb309-5" data-line-number="5"><span class="kw">colnames</span>(df_genes)</a>
<a class="sourceLine" id="cb309-6" data-line-number="6"><span class="kw">rownames</span>(df_genes)</a>
<a class="sourceLine" id="cb309-7" data-line-number="7"><span class="kw">class</span>(df_genes)</a></code></pre></div>
</details>
<p><strong>6- Select rows for which pvalue_KOvsWT &lt; 0.05 AND log2FoldChange_KOvsWT &gt; 0.5. Store in the up object.</strong></p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb310-1" data-line-number="1"><span class="co"># rows where pvalue_KOvsWT &lt; 0.05 </span></a>
<a class="sourceLine" id="cb310-2" data-line-number="2">df_genes<span class="op">$</span>pvalue_KOvsWT <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb310-3" data-line-number="3"><span class="co"># rows where log2FoldChange_KOvsWT &gt; 0.5</span></a>
<a class="sourceLine" id="cb310-4" data-line-number="4">df_genes<span class="op">$</span>log2FoldChange_KOvsWT <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb310-5" data-line-number="5"><span class="co"># rows that comply both of the above conditions</span></a>
<a class="sourceLine" id="cb310-6" data-line-number="6">df_genes<span class="op">$</span>pvalue_KOvsWT <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">&amp;</span><span class="st"> </span>df_genes<span class="op">$</span>log2FoldChange_KOvsWT <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb310-7" data-line-number="7"><span class="co"># select rows for which pvalue_KOvsWT &lt; 0.05 AND log2FoldChange_KOvsWT &gt; 0.5</span></a>
<a class="sourceLine" id="cb310-8" data-line-number="8">up &lt;-<span class="st"> </span>df_genes[df_genes<span class="op">$</span>pvalue_KOvsWT <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb310-9" data-line-number="9"><span class="st">                 </span>df_genes<span class="op">$</span>log2FoldChange_KOvsWT <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>,]</a></code></pre></div>
</details>
<p>How many rows (genes) were selected?</p>
<p><strong>7- Select from the up object the Zinc finger protein coding genes (i.e. the gene symbol starts with Zfp). Use the grep() function.</strong></p>
<details>
<p><summary>
correction<br />
</summary></p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb311-1" data-line-number="1"><span class="co"># extract gene symbol column</span></a>
<a class="sourceLine" id="cb311-2" data-line-number="2">up<span class="op">$</span>gene_symbol</a>
<a class="sourceLine" id="cb311-3" data-line-number="3"><span class="co"># use grep to get the genes matching the pattern &quot;Zfp&quot;</span></a>
<a class="sourceLine" id="cb311-4" data-line-number="4">up[<span class="kw">grep</span>(<span class="st">&quot;Zf&quot;</span>, up<span class="op">$</span>gene_symbol), ]</a></code></pre></div>
</details>
<p><strong>8- Select rows for which pvalue_KOvsWT &lt; 0.05 AND log2FoldChange_KOvsWT is &gt; 0.5 OR &lt; -0.5.</strong>
For the selection of log2FoldChange: give the <strong>abs</strong> function a try!
<br>Store in the diff_genes object.</p>
<details>
<p><summary>
correction
</summary></p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb312-1" data-line-number="1"><span class="co"># rows where pvalue_KOvsWT &lt; 0.05</span></a>
<a class="sourceLine" id="cb312-2" data-line-number="2">df_genes<span class="op">$</span>pvalue_KOvsWT <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb312-3" data-line-number="3"><span class="co"># rows where log2FoldChange_KOvsWT &gt; 0.5</span></a>
<a class="sourceLine" id="cb312-4" data-line-number="4">df_genes<span class="op">$</span>log2FoldChange_KOvsWT <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb312-5" data-line-number="5"><span class="co"># rows where log2FoldChange_KOvsWT &lt; -0.5</span></a>
<a class="sourceLine" id="cb312-6" data-line-number="6">df_genes<span class="op">$</span>log2FoldChange_KOvsWT <span class="op">&gt;</span><span class="st"> </span><span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb312-7" data-line-number="7"><span class="co"># rows where log2FoldChange_KOvsWT &lt; -0.5 OR log2FoldChange_KOvsWT &gt; 0.5</span></a>
<a class="sourceLine" id="cb312-8" data-line-number="8">df_genes<span class="op">$</span>log2FoldChange_KOvsWT <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">|</span><span class="st"> </span>df_genes<span class="op">$</span>log2FoldChange_KOvsWT <span class="op">&gt;</span><span class="st"> </span><span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb312-9" data-line-number="9"><span class="co"># same as above but using the abs function</span></a>
<a class="sourceLine" id="cb312-10" data-line-number="10"><span class="kw">abs</span>(df_genes<span class="op">$</span>log2FoldChange_KOvsWT) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb312-11" data-line-number="11"><span class="co"># combine all required criteria</span></a>
<a class="sourceLine" id="cb312-12" data-line-number="12">df_genes<span class="op">$</span>pvalue_KOvsWT <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(df_genes<span class="op">$</span>log2FoldChange_KOvsWT) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb312-13" data-line-number="13"><span class="co"># extract corresponding entries</span></a>
<a class="sourceLine" id="cb312-14" data-line-number="14">diff_genes &lt;-<span class="st"> </span>df_genes[df_genes<span class="op">$</span>pvalue_KOvsWT <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb312-15" data-line-number="15"><span class="st">                 </span><span class="kw">abs</span>(df_genes<span class="op">$</span>log2FoldChange_KOvsWT) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>,]</a></code></pre></div>
</details>
<p>How many rows (genes) were selected?</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-types.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="missing-values.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["r-intro-crg.pdf", "r-intro-crg.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
